/*Version 1.0.44.0*/VAMFG=window.VAMFG||{},function(n){function f(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutRoutingOperation")}function h(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutRoutingOperationResource")}function o(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutStandardOperation")}function c(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutStandardOperationResource")}function r(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrder")}function v(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderClass")}function l(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderComponent")}function u(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderOperation")}function p(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderResource")}function a(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderResourceTxnLine")}function i(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutWorkOrderTransaction")}function y(){VIS.CalloutEngine.call(this,"VAMFG.VAMFG_CalloutRouting")}var s=VIS.Logging.Level,t=VIS.Utility.Util;VIS.Utility.inheritPrototype(f,VIS.CalloutEngine);f.prototype.StandardOperation=function(n,i,r,u,f){var o,s,e;if(this.isCalloutActive()||f==null||f.toString()==""||(o=t.getValueOfInt(f),o==null||o==0))return"";s="SELECT VAMFG_M_Operation_ID, VAMFG_M_WorkCenter_ID, VAMFG_Description, VAMFG_Help, VAMFG_SetupTime, VAMFG_UnitRunTime, C_UOM_ID, VAMFG_IsPermitRequired, VAMFG_IsHazmat FROM VAMFG_M_StandardOperation WHERE VAMFG_M_StandardOperation_ID ="+o;e=null;try{for(this.setCalloutActive(!0),e=VIS.DB.executeReader(s,null,null);e.read();)r.setValue("VAMFG_M_Operation_ID",t.getValueOfInt(e.get("VAMFG_M_Operation_ID"))),r.setValue("VAMFG_M_WorkCenter_ID",t.getValueOfInt(e.get("VAMFG_M_WorkCenter_ID"))),r.setValue("VAMFG_Description",t.getValueOfString(e.get("VAMFG_Description"))),r.setValue("VAMFG_Help",t.getValueOfString(e.get("VAMFG_Help"))),r.setValue("VAMFG_SetupTime",t.getValueOfDecimal(e.get("VAMFG_SetupTime"))),r.setValue("VAMFG_UnitRuntime",t.getValueOfDecimal(e.get("VAMFG_UnitRuntime"))),r.setValue("C_UOM_ID",t.getValueOfInt(e.get("C_UOM_ID"))),r.setValue("VAMFG_IsPermitRequired",t.getValueOfBoolean(e.get("VAMFG_IsPermitRequired"))),r.setValue("VAMFG_IsHazmat",t.getValueOfBoolean(e.get("VAMFG_IsHazmat")));e!=null&&e.close()}catch(h){return e!=null&&e.close(),VIS.ADialog.info("Error Getting Information"+h,null,"",""),this.setCalloutActive(!1),h}return this.setCalloutActive(!1),""};f.prototype.SetC_UOM_ID=function(n,i,r,u,f){var o,e,h;if(this.isCalloutActive()||f==null||f.toString()==""||(o=t.getValueOfInt(f),o==0))return"";this.setCalloutActive(!0);var s=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),l=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),c=t.getValueOfDecimal(s.toFixed(l));return s.compareTo(c)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+o+"; Setup Time = "+s+"->"+c),s=c,r.setValue("VAMFG_SetupTime",s)),e=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),h=t.getValueOfDecimal(e.toFixed(l)),e.compareTo(h)!=0&&(this.log.fine("Corrected Runtime Per Unit Scale UOM="+o+"; Runtime Per Unit = "+e+"->"+h),e=h,r.setValue("VAMFG_UnitRuntime",e)),this.setCalloutActive(!1),""};f.prototype.SetSetupTime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==null||f.toString()==""||(o=t.getValueOfInt(r.getValue("C_UOM_ID")),o==0))return"";this.setCalloutActive(!0);var h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),e=t.getValueOfDecimal(f),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+o+"; Setup Time="+e+"->"+s),e=s,r.setValue("VAMFG_SetupTime",e)),this.setCalloutActive(!1),""};f.prototype.SetUnitRuntime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==null||f.toString()==""||(o=r.getValue("C_UOM_ID"),o==0))return"";this.setCalloutActive(!0);var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Runtime Per Unit UOM = "+o+"; Runtime Per Unit = "+e+"->"+s),e=s,r.setValue("VAMFG_UnitRuntime",e)),this.setCalloutActive(!1),""};n.CMFG=n.CMFG||{};n.CMFG.Model=n.CMFG.Model||{};n.CMFG.Model.VAMFG_CalloutRoutingOperation=f;VIS.Utility.inheritPrototype(h,VIS.CalloutEngine);h.prototype.Product=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0?(r.setValue("C_UOM_ID",null),""):(this.setCalloutActive(!0),o=VIS.dataContext.getJSONRecord("MProductUOM/SetProductValues",e.toString()),r.setValue("C_UOM_ID",t.getValueOfInt(o.C_UOM_ID)),r.setValue("VAMFG_ChargeType",o.VAMFG_ChargeType),r.setValue("BasisType",o.BasisType),this.setCalloutActive(!1),""))};h.prototype.SetQtyRequired=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=n.getContextAsInt(i,"C_UOM_ID",!1),o==0))return"";this.setCalloutActive(!0);var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected QtyRequired Scale UOM="+o+"; QtyRequired="+e+"->"+s),e=s,r.setValue("VAMFG_QtyRequired",e)),this.setCalloutActive(!1),""};n.CMFG.Model.VAMFG_CalloutRoutingOperationResource=h;VIS.Utility.inheritPrototype(o,VIS.CalloutEngine);o.prototype.Warehouse=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfInt(f),e==0)?(r.setValue("VAMFG_M_WorkCenter_ID",null),""):(o=VIS.dataContext.getJSONRecord("MWorkCenter/GetDefaultWorkCenter",e),o!=null?(r.setValue("VAMFG_M_WorkCenter_ID",o),""):(r.setValue("VAMFG_M_WorkCenter_ID",null),VIS.ADialog.info(Msg.getMsg(n,"WorkCenterNotDefined"))))};o.prototype.SetC_UOM_ID=function(n,i,r,u,f){var o,e,h;if(this.isCalloutActive()||f==null||f.toString()==""||(o=t.getValueOfInt(f),o==0))return"";this.setCalloutActive(!0);var s=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),l=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),c=t.getValueOfDecimal(s.toFixed(l));return s.compareTo(c)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+o+"; Setup Time = "+s+"->"+c),s=c,r.setValue("VAMFG_SetupTime",s)),e=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),h=t.getValueOfDecimal(e.toFixed(l)),e.compareTo(h)!=0&&(this.log.fine("Corrected Runtime Per Unit Scale UOM="+o+"; Runtime Per Unit = "+e+"->"+h),e=h,r.setValue("VAMFG_UnitRuntime",e)),this.setCalloutActive(!1),""};o.prototype.SetSetupTime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==null||f.toString()==""||(o=t.getValueOfInt(r.getValue("C_UOM_ID")),o==0))return"";this.setCalloutActive(!0);var h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),e=t.getValueOfDecimal(f),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+o+"; Setup Time="+e+"->"+s),e=s,r.setValue("VAMFG_SetupTime",e)),this.setCalloutActive(!1),""};o.prototype.SetUnitRuntime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==null||f.toString()==""||(o=r.getValue("C_UOM_ID"),o==0))return"";this.setCalloutActive(!0);var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Runtime Per Unit UOM = "+o+"; Runtime Per Unit = "+e+"->"+s),e=s,r.setValue("VAMFG_UnitRuntime",e)),this.setCalloutActive(!1),""};n.CMFG.Model.VAMFG_CalloutStandardOperation=o;VIS.Utility.inheritPrototype(c,VIS.CalloutEngine);c.prototype.Product=function(n,i,r,u,f){var e,s,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0?(r.setValue("C_UOM_ID",null),""):(this.setCalloutActive(!0),s=e.toString(),o=VIS.dataContext.getJSONRecord("MProductUOM/SetProductValues",s),r.setValue("C_UOM_ID",t.getValueOfInt(o.C_UOM_ID)),r.setValue("VAMFG_ChargeType",o.VAMFG_ChargeType),r.setValue("BasisType",o.BasisType),this.setCalloutActive(!1),""))};c.prototype.SetQtyRequired=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=n.getContextAsInt(i,"C_UOM_ID",!1),o==0))return"";this.setCalloutActive(!0);var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected QtyRequired Scale UOM="+o+"; QtyRequired="+e+"->"+s),e=s,r.setValue("VAMFG_QtyRequired",e)),this.setCalloutActive(!1),""};n.CMFG.Model.VAMFG_CalloutStandardOperationResource=c;VIS.Utility.inheritPrototype(r,VIS.CalloutEngine);r.prototype.BPartner=function(n,i,r,u,f){var s,l,e,a,v;if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(s=t.getValueOfInt(f),this.setCalloutActive(!0),s==null||s==0)return r.setValue("C_BPartner_Location_ID",null),r.setValue("AD_User_ID",null),r.setValue("C_Project_ID",null),this.setCalloutActive(!1),"";var h=0,c=0,p="SELECT c.AD_User_ID, loc.C_BPartner_Location_ID AS Location_ID FROM C_BPartner p LEFT OUTER JOIN C_BPartner_Location loc ON (p.C_BPartner_ID=loc.C_BPartner_ID AND loc.IsActive='Y') LEFT OUTER JOIN AD_User c ON (p.C_BPartner_ID=c.C_BPartner_ID) WHERE p.C_BPartner_ID="+s+" AND p.IsActive='Y' ORDER BY loc.Name ASC ",o=null;try{for(this.setCalloutActive(!0),o=VIS.DB.executeReader(p,null,null);o.read();)h=t.getValueOfInt(o.get("Location_ID")),c=t.getValueOfInt(o.get("AD_User_ID"));o!=null&&o.close()}catch(y){if(o!=null)return o.close(),VIS.ADialog.info("Error Getting Information"+y,null,"",""),this.setCalloutActive(!1),y}return l=t.getValueOfInt(r.getValue("C_Order_ID")),l!=null&&l!=0&&(e=VIS.dataContext.getJSONRecord("MGetMOrder/GetOrderDetails",l.toString()),s==t.getValueOfInt(e.C_BPartner_ID)&&(h=e.C_BPartner_Location_ID,c=e.AD_User_ID),s.toString().equals(n.getContext(e.WINDOW_INFO,e.TAB_INFO,"C_BPartner_ID"))&&(a=n.getContext(e.WINDOW_INFO,e.TAB_INFO,"C_BPartner_Location_ID"),a.length>0&&(h=t.getValueOfInt(a)),v=n.getContext(e.WINDOW_INFO,e.TAB_INFO,"AD_User_ID"),v.length>0&&(c=t.getValueOfInt(v)))),h==0?r.setValue("C_BPartner_Location_ID",null):r.setValue("C_BPartner_Location_ID",h),c==0?r.setValue("AD_User_ID",null):r.setValue("AD_User_ID",c),r.setValue("C_Project_ID",null),this.setCalloutActive(!1),""};r.prototype.Order=function(n,i,r,u,f,e){var s=t.getValueOfInt(f);if(this.setCalloutActive(!0),s==null||s==0)return r.setValue("C_OrderLine_ID",null),this.setCalloutActive(!1),"";var h=0,c=0,o=VIS.dataContext.getJSONRecord("GetMOrder/GetOrderValues",s.toString());return h=t.getValueOfInt(o.C_BPartner_Location_ID),c=t.getValueOfInt(o.AD_User_ID),r.setValue("C_OrderLine_ID",o.C_OrderLine_ID),r.setValue("C_BPartner_ID",o.C_BPartner_ID),h==0?r.setValue("C_BPartner_Location_ID",null):r.setValue("C_BPartner_Location_ID",h),c==0?r.setValue("AD_User_ID",null):r.setValue("AD_User_ID",c),r.setValue("VAMFG_PriorityRule",o.VAMFG_PriorityRule),t.getValueOfInt(o.C_Project_ID)==0?r.setValue("C_Project_ID",null):r.setValue("C_Project_ID",o.C_Project_ID),t.getValueOfInt(o.C_Campaign_ID)==0?r.setValue("C_Campaign_ID",null):r.setValue("C_Campaign_ID",o.C_Campaign_ID),t.getValueOfInt(o.C_Activity_ID)==0?r.setValue("C_Activity_ID",null):r.setValue("C_Activity_ID",o.C_Activity_ID),t.getValueOfInt(o.AD_OrgTrx_ID)==0?r.setValue("AD_OrgTrx_ID",null):r.setValue("AD_OrgTrx_ID",o.AD_OrgTrx_ID),t.getValueOfInt(o.VAMFG_User1_ID)==0?r.setValue("VAMFG_User1_ID",null):r.setValue("VAMFG_User1_ID",o.VAMFG_User1_ID),t.getValueOfInt(o.VAMFG_User2_ID)==0?r.setValue("VAMFG_User2_ID",null):r.setValue("VAMFG_User2_ID",o.VAMFG_User2_ID),r.setValue("VAMFG_Description",o.Description),this.setCalloutActive(!1),n=i=r=u=f=e=null,""};r.prototype.OrderLine=function(n,i,r,u,f){var o,e;return this.isCalloutActive()||f==null||f.toString()==""?"":(o=t.getValueOfInt(f),this.setCalloutActive(!0),o==null||o==0)?(this.setCalloutActive(!1),""):(e=VIS.dataContext.getJSONRecord("GetMOrderLine/GetOrderLine",o.toString()),r.setValue("M_Product_ID",e.M_Product_ID),r.setValue("M_AttributeSetInstance_ID",e.M_AttributeSetInstance_ID),r.setValue("VAMFG_QtyEntered",e.QtyEntered),r.setValue("C_UOM_ID",e.C_UOM_ID),e.M_BOM_ID!=""&&e.M_BOM_ID!=null&&r.setValue("M_BOM_ID",e.M_BOM_ID),this.setCalloutActive(!1),"")};r.prototype.Product=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),this.setCalloutActive(!0),e==null||e==0)?(r.setValue("M_BOM_ID",null),r.setValue("C_UOM_ID",null),r.setValue("VAMFG_M_Routing_ID",null),this.setCalloutActive(!1),""):(t.getValueOfInt(r.getValue("C_OrderLine_ID"))==0&&(o=VIS.dataContext.getJSONRecord("GetMBom/GetMBomData",e.toString()),o!=0?r.setValue("M_BOM_ID",o):r.setValue("M_BOM_ID",null)),this.setCalloutActive(!1),"")};r.prototype.SetQtyEntered=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==null||f.toString()==""||(o=n.getContextAsInt(i,"C_UOM_ID"),0==o))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected QtyEntered Scale UOM="+o+"; QtyEntered="+e+"->"+s),e=s,r.setValue("VAMFG_QtyEntered",e)),""};r.prototype.Supervisor=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";var e=t.getValueOfInt(f);return e==0?"":(r.getValue("SalesRep_ID")==null&&r.getValue("SalesRep_ID",e),"")};r.prototype.WOSource=function(n,i,r,u,f){if(this.isCalloutActive()||f==null||f.toString()=="")return"";var e=t.getValueOfString(f);return(e==null||e.Length==0)&&(r.setValue("C_Order_ID",null),r.setValue("C_OrderLine_ID",null)),""};r.prototype.Warehouse=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),this.setCalloutActive(!0),e==null||e==0)?(r.setValue("M_Locator_ID",null),this.setCalloutActive(!1),""):(o=VIS.dataContext.getJSONRecord("GetWarehouse/GetLocator",e.toString()),r.setValue("M_Locator_ID",o),this.setCalloutActive(!1),"")};r.prototype.WoType=function(n,i,r,u,f){var h;if(this.isCalloutActive()||f==null||f.toString()=="")return"";if(h=t.getValueOfString(f),h==null||h.Length==0)return r.setValue("VAMFG_M_WorkOrderClass_ID",null),"";r.setValue("VAMFG_M_WorkOrderClass_ID",null);var l=t.getValueOfInt(r.getValue("AD_Org_ID")),a=t.getValueOfInt(r.getValue("AD_Client_ID")),c="SELECT VAMFG_M_WorkOrderClass_ID FROM VAMFG_M_WorkOrderClass WHERE AD_Org_ID IN (0, "+l+") AND AD_Client_ID = "+a+" AND VAMFG_WOType = '"+h+"' AND VAMFG_IsDefault = 'Y' AND IsActive = 'Y' ORDER BY AD_Org_ID DESC",o=null;try{o=VIS.DB.executeReader(c,null,null);o.read()?r.setValue("VAMFG_M_WorkOrderClass_ID",t.getValueOfInt(o[0])):r.setValue("VAMFG_M_WorkOrderClass_ID",null);o!=null&&(o.close(),o=null)}catch(v){return o!=null&&(o.close(),o=null),this.log.log(s.SEVERE,c,e),v.message}return""};r.prototype.WorkorderClass=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(this.setCalloutActive(!0),e=t.getValueOfInt(f),e==null||e==0)?(r.setValue("C_DocType_ID",null),this.setCalloutActive(!1),""):(o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetWODocType",e.toString()),r.setValue("C_DocType_ID",o),this.setCalloutActive(!1),"")};r.prototype.AttributeSet=function(n,i,r,u,f){var e=t.getValueOfInt(f),o,s;return this.setCalloutActive(!0),e>0&&(t.getValueOfInt(r.getValue("C_OrderLine_ID"))==0&&(o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetAttribute",e.toString()),r.setValue("M_AttributeSetInstance_ID",o)),s=r.getValue("M_Product_ID")+","+r.getValue("M_Warehouse_ID")+","+r.getValue("M_AttributeSetInstance_ID"),bom=VIS.dataContext.getJSONRecord("GetMBom/GetMVAMFGMRouting",s.toString()),bom.VAMFG_M_Routing_ID!=0?r.setValue("VAMFG_M_Routing_ID",t.getValueOfInt(bom.VAMFG_M_Routing_ID)):r.setValue("VAMFG_M_Routing_ID",null),bom.C_UOM_ID!=0&&r.setValue("C_UOM_ID",t.getValueOfInt(bom.C_UOM_ID))),this.setCalloutActive(!1),""};n.CMFG.Model.VAMFG_CalloutWorkOrder=r;VIS.Utility.inheritPrototype(v,VIS.CalloutEngine);v.prototype.IsDefault=function(n,i,r,u,f){var e,c;if(this.isCalloutActive()||f==""||f.toString()==""||(e=Boolean(f?"Y":"N"),e==null||e.length==0))return"";if(e=="true"){var l=r.getValueOfString("WOType"),a=t.getValueOfInt(r.getValue("AD_Org_ID")),v=t.getValueOfInt(r.getValue("AD_Client_ID")),o=r.getValue("VAMFG_M_WorkOrderClass_ID"),y=0,h="UPDATE VAMFG_M_WorkOrderClass SET VAMFG_IsDefault = 'N' WHERE VAMFG_WOType = "+l+" AND AD_Org_ID = "+a+"  AND AD_Client_ID = "+v+" AND VAMFG_M_WorkOrderClass_ID != "+o+"";o!=null&&(y=t.getValueOfInt(o));try{c=VIS.DB.executeQuery(h,null,null);c!=1&&this.log.message("M_WorkOrderClass","M_WorkOrderClass Not Updated")}catch(p){return this.log.log(s.SEVERE,h),""}}return""};n.CMFG.Model.VAMFG_CalloutWorkOrderClass=v;VIS.Utility.inheritPrototype(l,VIS.CalloutEngine);l.prototype.Product=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0)?(r.setValue("C_UOM_ID",null),""):(o=VIS.dataContext.getJSONRecord("MProductUOM/GetUOM",e.toString()),r.setValue("C_UOM_ID",o),"")};l.prototype.SetQtyRequired=function(n,i,r,u,f){var e,o,h,s;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfDecimal(f),o=t.getValueOfInt(f),o==0)?"":(h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h),e.compareTo(s)!=0&&(this.log.fine("Corrected VAMFG_QtyRequired Scale UOM="+o+"; VAMFG_QtyRequired="+e+"->"+s),e=s,r.setValue("VAMFG_QtyRequired",e)),"")};n.CMFG.Model.VAMFG_CalloutWorkOrderComponent=l;VIS.Utility.inheritPrototype(u,VIS.CalloutEngine);u.prototype.SetC_UOM_ID=function(n,i,r,u,f){var e;if(this.isCalloutActive()||f==""||f.toString()==""||(e=t.getValueOfInt(f),e==0))return"";var o=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",e.toString()),c=t.getValueOfDecimal(o.toFixed(h));o.compareTo(c)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+e+"; Setup Time = "+o+"->"+c),o=c,r.setValue("VAMFG_SetupTime",o));var s=t.getValueOfDecimal(r.getValue("VAMFG_SetupTime")),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",e.toString()),l=t.getValueOfDecimal(s.toFixed(h));return s.compareTo(l)!=0&&(this.log.fine("Corrected Runtime Per Unit Scale UOM="+e+"; Runtime Per Unit = "+s+"->"+l),s=l,r.setValue("VAMFG_UnitRunTime",s)),""};u.prototype.SetSetupTime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=t.getValueOfInt(r.getValue("C_UOM_ID")),0==o))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Setup Time Scale UOM="+o+"; Setup Time="+e+"->"+s),e=s,r.setValue("VAMFG_SetupTime",e)),""};u.prototype.SetUnitRuntime=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=t.getValueOfInt(r.getValue("C_UOM_ID")),0==o))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=t.getValueOfDecimal(e.toFixed(h));return e.compareTo(s)!=0&&(this.log.fine("Corrected Runtime Per Unit UOM = "+o+"; Runtime Per Unit = "+e+"->"+s),e=s,r.setValue("VAMFG_UnitRunTime",e)),""};u.prototype.StandardOperation=function(n,i,r,u,f){var h,c,o;if(this.isCalloutActive()||f==""||f.toString()==""||(h=t.getValueOfInt(f),h==null||h==0))return"";c="SELECT VAMFG_M_Operation_ID, VAMFG_M_WorkCenter_ID, VAMFG_Description, VAMFG_SetupTime, VAMFG_UnitRunTime, C_UOM_ID, VAMFG_IsPermitRequired, VAMFG_IsHazmat FROM VAMFG_M_StandardOperation WHERE VAMFG_M_StandardOperation_ID = "+h+"";o=null;try{for(o=VIS.DB.executeReader(c,null,null);o.read();)r.setValue("VAMFG_M_Operation_ID",t.getValueOfInt(o.get("VAMFG_M_Operation_ID"))),r.setValue("VAMFG_M_WorkCenter_ID",t.getValueOfInt(o.get("VAMFG_M_WorkCenter_ID"))),r.setValue("VAMFG_Description",t.getValueOfInt(o.get("VAMFG_Description"))),r.setValue("VAMFG_SetupTime",t.getValueOfInt(o.get("VAMFG_SetupTime"))),r.setValue("VAMFG_UnitRunTime",t.getValueOfInt(o.get("VAMFG_UnitRunTime"))),r.setValue("C_UOM_ID",t.getValueOfInt(o.get("C_UOM_ID"))),r.setValue("VAMFG_IsPermitRequired",t.getValueOfInt(o.get("VAMFG_IsPermitRequired"))),r.setValue("VAMFG_IsHazmat",t.getValueOfInt(o.get("VAMFG_IsHazmat")));o!=null&&(o.close(),o=null)}catch(l){o!=null&&(o.close(),o=null);this.log.log(s.SEVERE,c,e)}return""};n.CMFG.Model.VAMFG_CalloutWorkOrderOperation=u;VIS.Utility.inheritPrototype(p,VIS.CalloutEngine);u.prototype.Product=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||0==e)?(r.setValue("C_UOM_ID",null),""):(o=VIS.dataContext.getJSONRecord("MProductUOM/SetProductValues",e.toString()),r.setValue("C_UOM_ID",t.getValueOfInt(o.C_UOM_ID)),r.setValue("VAMFG_ChargeType",o.VAMFG_ChargeType),r.setValue("BasisType",o.BasisType),"")};u.prototype.SetQtyRequired=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=n.getContextAsInt(i,"C_UOM_ID"),o==0))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected QtyRequired Scale UOM="+o+"; QtyRequired="+e+"->"+s),e=s,r.setValue("VAMFG_QtyRequired",e)),""};n.CMFG.Model.VAMFG_CalloutWorkOrderResource=p;VIS.Utility.inheritPrototype(a,VIS.CalloutEngine);a.prototype.Product=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0)?(r.setValue("C_UOM_ID",null),""):(o=VIS.dataContext.getJSONRecord("MProductUOM/GetUOM",e.toString()),r.setValue("C_UOM_ID",o),"")};a.prototype.SetQtyRequired=function(n,i,r,u,f){var e;if(this.isCalloutActive()||f==""||f.toString()==""||(e=n.getContextAsInt(i,"C_UOM_ID"),e==0))return"";var o=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",e.toString()),s=QtyRequired.toFixed(h);return o.compareTo(s)!=0&&(this.log.fine("Corrected QtyEntered Scale UOM="+e+"; QtyEntered="+o+"->"+s),o=s,r.setValue("VAMFG_QtyEntered",o)),""};n.CMFG.Model.VAMFG_CalloutWorkOrderResourceTxnLine=a;VIS.Utility.inheritPrototype(i,VIS.CalloutEngine);i.prototype.Product=function(n,i,r,u,f){var e,o,s;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0)?"":(this.setCalloutActive(!0),o=0,n.getContextAsInt(i,"M_Product_ID",!1)==e&&n.getContextAsInt(i,"M_AttributeSetInstance_ID",!1)!=0?(o=n.getContextAsInt(i,"M_AttributeSetInstance_ID",!1),r.setValue("M_AttributeSetInstance_ID",o)):r.setValue("M_AttributeSetInstance_ID",null),s=VIS.dataContext.getJSONRecord("MProductUOM/GetUOM",e.toString()),r.setValue("C_UOM_ID",s),this.setCalloutActive(!1),"")};i.prototype.SetHeaderQtyEntered=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=n.getContextAsInt(i,"C_UOM_ID"),o==0))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected VAMFG_QtyEntered Scale UOM="+o+"; VAMFG_QtyEntered="+e+"->"+s),e=s,r.setValue("VAMFG_QtyEntered",e)),""};i.prototype.SetLineQtyEntered=function(n,i,r,u,f){var o;if(this.isCalloutActive()||f==""||f.toString()==""||(o=t.getValueOfInt(r.getValue("C_UOM_ID")),o==0))return"";var e=t.getValueOfDecimal(f),h=VIS.dataContext.getJSONRecord("MGetUOM/GetPrecision",o.toString()),s=e.toFixed(h);return e.compareTo(s)!=0&&(this.log.fine("Corrected VAMFG_QtyEntered Scale UOM="+o+"; VAMFG_QtyEntered="+e+"->"+s),e=s,r.setValue("VAMFG_QtyEntered",e)),""};i.prototype.SetOperationTo_ID=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==""?"":(e=t.getValueOfInt(f),e<0)?"":(o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetOperationTo_ID",e.toString()),o==!0?r.setValue("VAMFG_IsOptionalTo",!0):r.setValue("VAMFG_IsOptionalTo",!1),"")};i.prototype.SetOperationFrom_ID=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),e<0)?"":(o=VIS.dataContext.getJSONRecord("GetMWorkOrder/SetOperationFrom_ID",e.toString()),o==!0?r.setValue("VAMFG_IsOptionalFrom",!0):r.setValue("VAMFG_IsOptionalFrom",!1),"")};i.prototype.SetStepFrom=function(n,i,r,u,f){var s,h,c,e;if(this.isCalloutActive()||f==""||f==null)return r.setValue("VAMFG_QtyEntered",0),"";var l=t.getValueOfInt(r.getValue("M_Product_ID")),o=t.getValueOfInt(r.getValue("OperationFrom_ID")),a=t.getValueOfInt(r.getValue("VAMFG_M_WorkOrder_ID"));if(o<=0)return"";if(s=t.getValueOfString(f),h=t.getValueOfString(r.getValue("VAMFG_WorkOrderTxnType")),h=="WM"){if(c=o.toString().concat(",")+s.concat(",")+l.toString().concat(",")+a.toString(),e=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetMWorkOrderOperation",c.toString()),e.Value=="Q")return r.setValue("VAMFG_QtyEntered",t.getValueOfDecimal(e.Q)),"";if(e.Value=="R")return r.setValue("VAMFG_QtyEntered",t.getValueOfDecimal(e.R)),"";if(e.Value=="T")return r.setValue("VAMFG_QtyEntered",t.getValueOfDecimal(e.T)),""}return""};i.prototype.WoComplete=function(n,i,r,u,f){var e,s,o;if(f==null||f.toString().equals("N")||r.getValue("VAMFG_M_WorkOrder_ID")==null)return"";var l=t.getValueOfInt(r.getValue("VAMFG_M_WorkOrder_ID")),h="SELECT VAMFG_M_WorkOrderOperation_ID FROM VAMFG_M_WorkOrderOperation WHERE VAMFG_M_WorkOrder_ID = "+l+" AND VAMFG_IsOptional <> 'Y' ORDER BY VAMFG_SeqNo DESC",e=null,c=!0;try{e=null;s=0;e=VIS.DB.executeReader(h,null,null);e.read()&&(s==0?(o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetMWorkOrderOperationDATA",e.tables[0].rows[0].cells.vamfg_m_workorderoperation_id.toString()),s=1):c=!1);e!=null&&(e.close(),e=null)}catch(a){return e!=null&&(e.close(),e=null),this.log.severe(h),""}return c?(o!=null&&(r.setValue("OperationTo_ID",t.getValueOfInt(o.VAMFG_M_WorkOrderOperation_ID)),t.getValueOfBoolean(o.IsVAMFG_IsOptional)==!0?r.setValue("VAMFG_IsOptionalTo",!0):r.setValue("VAMFG_IsOptionalTo",!1),r.setValue("VAMFG_StepTo","T")),""):""};i.prototype.WorkOrderID=function(n,r,u,f,e){var s,o;return this.isCalloutActive()||e==""||e.toString()==""?"":(s=t.getValueOfInt(e),s==0)?"":(this.setCalloutActive(!0),o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetworkOrder",s.toString()),u.setValue("M_Product_ID",o.M_Product_ID),u.setValue("C_UOM_ID",o.C_UOM_ID),u.setValue("M_Locator_ID",o.M_Locator_ID),o.C_BPartner_ID!=0&&u.setValue("C_BPartner_ID",o.C_BPartner_ID),u.setValue("C_BPartner_Location_ID",o.C_BPartner_Location_ID),u.setValue("AD_User_ID",o.AD_User_ID),u.setValue("C_Project_ID",o.C_Project_ID),u.setValue("C_Campaign_ID",o.C_Campaign_ID),u.setValue("C_Activity_ID",o.C_Activity_ID),u.setValue("User1_ID",o.VAMFG_User1_ID),u.setValue("User2_ID",o.VAMFG_User2_ID),u.setValue("M_AttributeSetInstance_ID",o.M_AttributeSetInstance_ID),i.prototype.DocType(n,r,u,f,o.WOT_DocType_ID,o.C_DocType_ID),this.setCalloutActive(!1),"")};i.prototype.DocType=function(n,i,r,u,f,e){var o,v,l,h,c,a,y;if(f==""||f.toString()==""||(o=t.getValueOfInt(f),o==null||o==0))return"";v=t.getValueOfString(r.getValue("DocumentNo"));l=t.getValueOfBoolean(v==null);l||(l=!0);h=t.getValueOfInt(r.getValue("C_DocType_ID"));(h==null||h==0)&&e!=null&&(h=t.getValueOfInt(e));c="SELECT 'N',d.IsDocNoControlled,s.CurrentNext, d.DocBaseType, s.CurrentNextSys, s.AD_Sequence_ID FROM C_DocType d LEFT OUTER JOIN AD_Sequence s ON (d.DocNoSequence_ID=s.AD_Sequence_ID) WHERE C_DocType_ID= "+h+" ";try{a=0;h!=0&&(idr=VIS.DB.executeReader(c,null,null),idr.read()&&(a=t.getValueOfInt(idr[5])),idr!=null&&(idr.close(),idr=null));c="SELECT 'N',d.IsDocNoControlled,s.CurrentNext, d.DocBaseType, s.CurrentNextSys, s.AD_Sequence_ID FROM C_DocType d LEFT OUTER JOIN AD_Sequence s ON (d.DocNoSequence_ID=s.AD_Sequence_ID) WHERE C_DocType_ID= "+o+" ";idr=VIS.DB.executeReader(c,null,null);idr.read()&&(r.setValue("C_DocType_ID",o),r.setValue("C_DocTypeTarget_ID",o),t.getValueOfString(idr[1]).equals("Y")&&(a!=t.getValueOfInt(idr[5])&&(l=!0),l&&(VIS.Ini.isPropertyBool(VIS.Ini.P_VIENNASYS)&&VIS.Envs.GetCtx().GetAD_Client_ID()<1e6?r.setValue("DocumentNo","<"+t.getValueOfString(idr[4])+">"):r.setValue("DocumentNo","<"+t.getValueOfString(idr[2])+">"))),y=t.getValueOfString(idr[3]),n.setContext(i,"DocBaseType",y));idr!=null&&(idr.close(),idr=null)}catch(p){return idr!=null&&(idr.close(),idr=null),this.log.log(s.SEVERE,c),c}return""};i.prototype.WorkOrderTxnType=function(n,i,r,u,f){var e,s,o;return this.isCalloutActive()||f==""||f.toString()==""?"":(e=t.getValueOfString(f),e==null||e.length==0)?"":(this.setCalloutActive(!0),(e.equals("AR")||e.equals("AI"))&&(s=t.getValueOfInt(r.getValue("VAMFG_M_WorkOrder_ID")),o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetAssembledQty",s.toString()),o!=null&&(r.setValue("OperationFrom_ID",o.OperationID),e.equals("AR")?r.setValue("VAMFG_QtyEntered",o.QtyReturn):r.setValue("VAMFG_QtyEntered",o.Qty))),this.setCalloutActive(!1),"")};i.prototype.CalculateLitreQuantity=function(n,t,i,r,u){if(this.isCalloutActive()||u==""||u.toString()=="")return"";this.setCalloutActive(!0);var f=i.getValue("VAMFG_QtyEntered"),e=i.getValue("GOM01_Density"),o="";if(f==0||e==0)return this.setCalloutActive(!1),"Value cannot be 0";try{o=(f/e).toPrecision(6);i.setValue("GOM01_Litre",o)}catch(s){this.setCalloutActive(!1);this.log.severe(s.toString())}return this.setCalloutActive(!1),""};n.CMFG.Model.VAMFG_CalloutWorkOrderTransaction=i;VIS.Utility.inheritPrototype(y,VIS.CalloutEngine);y.prototype.Attribute=function(n,i,r,u,f){var e,o;return this.isCalloutActive()||f==null||f.toString()==""?"":(e=t.getValueOfInt(f),e==null||e==0)?"":(this.setCalloutActive(!0),o=VIS.dataContext.getJSONRecord("GetMWorkOrder/GetAttributeValue",e.toString()),o!=null&&r.setValue("VAMFG_M_AttributeName",o),this.setCalloutActive(!1),"")};n.CMFG.Model.VAMFG_CalloutRouting=y}(VAMFG,jQuery);VAMFG=window.VAMFG||{},function(n,t){function i(){function ar(){t.ajax({url:VIS.Application.contextUrl+"VAMFG/WavePlanningImp/Index",type:"Get",async:!1,data:{windowno:$Self.windowNo},success:function(n){yr(n)},error:function(n){alert(n)}})}function vr(){_MLocator.click(function(){kr()});b.on("keypress keyup blur",function(n){t(this).val(t(this).val().replace(/[^\d].+/,""));(n.which<48||n.which>57)&&n.preventDefault()});rt.on("keypress keyup blur",function(n){t(this).val(t(this).val().replace(/[^\d].+/,""));(n.which<48||n.which>57)&&n.preventDefault()});nt.on("keypress keyup blur",function(n){t(this).val(t(this).val().replace(/[^\d].+/,""));(n.which<48||n.which>57)&&n.preventDefault()});tt.on("keypress keyup blur",function(n){t(this).val(t(this).val().replace(/[^\d].+/,""));(n.which<48||n.which>57)&&n.preventDefault()});u.change(function(){u.val()=="0"?u.css("background-color",vt(!0)):u.css("background-color",vt(!1))});w.on("click",function(){w.is(":checked")?(k.css("visibility","visible"),ot.css("visibility","visible")):(k.css("visibility","hidden"),ot.css("visibility","hidden"))});st.on("click",function(){at=st.is(":checked")?!0:!1});g.on("click",function(){var t=tu(),i,n;t=="OK"?(g.prop("disabled",!0),w2ui["WaveGrid"+$Self.windowNo].clear(),w2ui["WaveGrid"+$Self.windowNo].selectNone(),i=vu(),n=VIS.dataContext.getJSONRecord("GetGridData/GetDATA",i),g.prop("disabled",!1),n==isLocked?(ir(),VIS.ADialog.info(VIS.Msg.getMsg("VAMFG_NoRecordsFound"),null,"","")):w2ui["WaveGrid"+$Self.windowNo].add(n)):VIS.ADialog.info(VIS.Msg.getMsg(t),null,"","")});it.on("click",function(){var f,n,t;if(f=nu(),f=="OK"){it.prop("disabled",!0);var i=w2ui["WaveGrid"+$Self.windowNo].getSelection(),r=b.val(),u=[];if(i>0&&VIS.Utility.Util.getValueOfInt(r)>0)VIS.ADialog.info(VIS.Msg.getMsg("VAMFG_Rows_Process_Both_Specified"),null,"","");else if(i==0&&VIS.Utility.Util.getValueOfInt(r)==0)VIS.ADialog.info(VIS.Msg.getMsg("VAMFG_Rows_Process_NotSelected"),null,"","");else if(i.length>0){for(n=0;n<i.length;n++)t={},t.productname=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].ProductName),t.WorkOrderNo=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].WorkOrderNo),t.DateFrom=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].DateFrom),t.DateTo=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].DateTo),t.WorkOrderOperation=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].WorkOrderOperation),t.recid=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].recid),u.push(t);$BusyIndicator[0].style.visibility="visible";sr(u)}else if(VIS.Utility.Util.getValueOfInt(r)>0){for(n=0;n<VIS.Utility.Util.getValueOfInt(r);n++)t={},t.productname=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].ProductName),t.WorkOrderNo=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].WorkOrderNo),t.DateFrom=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].DateFrom),t.DateTo=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].DateTo),t.WorkOrderOperation=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].WorkOrderOperation),t.recid=VIS.Utility.Util.getValueOfString(w2ui["WaveGrid"+$Self.windowNo].records[VIS.Utility.Util.getValueOfInt(w2ui["WaveGrid"+$Self.windowNo].getSelection()[n])-1].recid),u.push(t);$BusyIndicator[0].style.visibility="visible";sr(u)}else VIS.ADialog.info(VIS.Msg.getMsg("VAMFG_RecordNotSelected"),null,"","")}else VIS.ADialog.info(VIS.Msg.getMsg(f),null,"","");it.prop("disabled",!1)})}function yr(i){i!=null&&(n=t(i),pr(),wr())}function pr(){_ProductControl=n.find("#VAMFG_ProductControl_"+$Self.windowNo);_BPControl=n.find("#VAMFG_BPartnerControl_"+$Self.windowNo);_MLocator=n.find("#VAMFG_MLocatorBtn_"+$Self.windowNo);e=n.find("#VAMFG_MLocatorControl_"+$Self.windowNo);wt=n.find("#VAMFG_WaveGridView_"+$Self.windowNo);w=n.find("#VAMFG_chkGeneratePickLst_"+$Self.windowNo);k=n.find("#VAMFG_chkPrintPickLst_"+$Self.windowNo);ot=n.find("#VAMFG_ParPrintPickLst_"+$Self.windowNo);f=n.find("#VAMFG_WHCombo_"+$Self.windowNo);o=n.find("#VAMFG_WOTypeCombo_"+$Self.windowNo);a=n.find("#VAMFG_WOCombo_"+$Self.windowNo);v=n.find("#VAMFG_WorkCntrCombo_"+$Self.windowNo);ft=n.find("#VAMFG_WrkOrdrTypeCombo_"+$Self.windowNo);y=n.find("#VAMFG_PriorityCombo_"+$Self.windowNo);et=n.find("#VAMFG_WrkOrdrSrtCombo_"+$Self.windowNo);d=n.find("#VAMFG_SourceZonecmbo_"+$Self.windowNo);u=n.find("#VAMFG_WrkOrdrFullRuleCom_"+$Self.windowNo);p=n.find("#VAMFG_TaskTypeCombo_"+$Self.windowNo);lt=n.find("#VAMFG_PickMethodCombo_"+$Self.windowNo);ti=n.find("#VAMFG_DocActionCombo_"+$Self.windowNo);g=n.find("#VAMFG_SearchBtn"+$Self.windowNo);nt=n.find("#VAMFG_OpertSeqTxtbx_"+$Self.windowNo);tt=n.find("#VAMFG_lbl1Txtbx_"+$Self.windowNo);s=n.find("#VAMFG_OpertnlSheduledDateFromCtrl_"+$Self.windowNo);h=n.find("#VAMFG_lbl2DateCtrl_"+$Self.windowNo);c=n.find("#VAMFG_OpertnlSheduledDateToCtrl_"+$Self.windowNo);l=n.find("#VAMFG_lbl3DateCtrl_"+$Self.windowNo);st=n.find("#VAMFG_chkSupervisedOperation_"+$Self.windowNo);b=n.find("#VAMFG_ProcessRowTxtBx_"+$Self.windowNo);it=n.find("#VAMFG_ProcessBtn"+$Self.windowNo);rt=n.find("#VAMFG_ClusterSizeTxtBx_"+$Self.windowNo);ut=n.find("#VAMFG_DocActionCombo_"+$Self.windowNo);k.css("visibility","hidden");ot.css("visibility","hidden");ii=n.find("#VAMFG_WHLabel_"+$Self.windowNo);ri=n.find("#VAMFG_WOTypeLbl_"+$Self.windowNo);ui=n.find("#VAMFG_WOLabel_"+$Self.windowNo);fi=n.find("#VAMFG_Productlbl_"+$Self.windowNo);ei=n.find("#VAMFG_OpertSeqLbl_"+$Self.windowNo);oi=n.find("#VAMFG_WorkCenterlbl_"+$Self.windowNo);si=n.find("#VAMFG_BPartnerlbl_"+$Self.windowNo);hi=n.find("#VAMFG_OpertnlSheduledDateFromLbl_"+$Self.windowNo);ci=n.find("#VAMFG_OpertnlSheduledDateToLbl_"+$Self.windowNo);li=n.find("#VAMFG_PriorityLbl_"+$Self.windowNo);ai=n.find("#VAMFG_WrkOrdrTypeLbl_"+$Self.windowNo);vi=n.find("#VAMFG_WrkOrdrSrtCrytLbl_"+$Self.windowNo);yi=n.find("#VAMFG_ProcessRowLbl_"+$Self.windowNo);pi=n.find("#VAMFG_SourceZoneLbl_"+$Self.windowNo);wi=n.find("#VAMFG_WrkOrdrFullRuleLbl_"+$Self.windowNo);bi=n.find("#VAMFG_PickMethodLbl_"+$Self.windowNo);ki=n.find("#VAMFG_ClusterSizeLbl_"+$Self.windowNo);di=n.find("#VAMFG_TaskTypeLbl_"+$Self.windowNo);gi=n.find("#VAMFG_MLocatorLbl_"+$Self.windowNo);nr=n.find("#VAMFG_DocActionLbl_"+$Self.windowNo);tr=n.find("#VAMFG_ProcessBtn"+$Self.windowNo)}function wr(){br();vr();pu();gr();iu();eu();fu();ru();uu();ou();su();hu();cu();lu();au();wu();u.css("background-color",vt(!0))}function br(){yt=VIS.MLookupFactory.get(VIS.Env.getCtx(),$Self.windowNo,1402,VIS.DisplayType.Search,"M_Product_ID",0,!1,null);$ProductControl=new VIS.Controls.VTextBoxButton("M_Product_ID",!1,!1,!0,VIS.DisplayType.Search,yt);$ProductControl.getControl().css("width","74%");$ProductControl.getControl().css("height","30px");$ProductControl.getBtn(0).css("width","13%");$ProductControl.getBtn(1).css("width","13%");_ProductControl.append($ProductControl.getControl());_ProductControl.append($ProductControl.getBtn(0));_ProductControl.append($ProductControl.getBtn(1));$ProductControl.fireValueChanged=function(){ht=$ProductControl.value};pt=VIS.MLookupFactory.get(VIS.Env.getCtx(),$Self.windowNo,2893,VIS.DisplayType.Search,"C_BPartner_ID",0,!1,null);$BPartnerCntrl=new VIS.Controls.VTextBoxButton("C_BPartner_ID",!1,!1,!0,VIS.DisplayType.Search,pt);$BPartnerCntrl.getControl().css("width","74%");$BPartnerCntrl.getControl().css("height","30px");$BPartnerCntrl.getBtn(0).css("width","13%");$BPartnerCntrl.getBtn(1).css("width","13%");_BPControl.append($BPartnerCntrl.getControl());_BPControl.append($BPartnerCntrl.getBtn(0));_BPControl.append($BPartnerCntrl.getBtn(1));$BPartnerCntrl.fireValueChanged=function(){ct=$BPartnerCntrl.value}}function kr(){function lt(){_LocatorsGrid=$Locator.find("#VAWMS_Loc_Grid");tt=$Locator.find("#VAWMS_Loc_WHLabel");h=$Locator.find("#VAWMS_Loc_WHCombo");it=$Locator.find("#VAWMS_Loc_SrchKeyLabel");g=$Locator.find("#VAWMS_Loc_SrchKey");rt=$Locator.find("#VAWMS_Loc_LocLabel");c=$Locator.find("#VAWMS_Loc_Locator");ut=$Locator.find("#VAWMS_Loc_AisleLabel");l=$Locator.find("#VAWMS_Loc_Aisle");ft=$Locator.find("#VAWMS_Loc_BayLabel");a=$Locator.find("#VAWMS_Loc_Bay");et=$Locator.find("#VAWMS_Loc_RowLabel");v=$Locator.find("#VAWMS_Loc_Row");ot=$Locator.find("#VAWMS_Loc_PositionLabel");y=$Locator.find("#VAWMS_Loc_Position");st=$Locator.find("#VAWMS_Loc_BinLabel");p=$Locator.find("#VAWMS_Loc_Bin");ht=$Locator.find("#VAWMS_Loc_PromiseLabel");o=$Locator.find("#VAWMS_Loc_Promise");ct=$Locator.find("#VAWMS_Loc_AllocationLabel");s=$Locator.find("#VAWMS_Loc_Allocation");nt=$Locator.find("#VAWMS_Loc_SrchBtn")}function at(){var t="select Name,m_WareHouse_ID from M_Warehouse where M_Warehouse.IsWMSEnabled='Y'  and Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+" ",n;if(_DsMain=VIS.DB.executeDataSet(t.toString(),null),h.html(""),h.append("<option value=0 ><\/option>"),_DsMain!=null)for(n=0;n<_DsMain.tables[0].rows.length;n++)h.append("<option value="+VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.m_warehouse_id)+">"+_DsMain.tables[0].rows[n].cells.name+"<\/option>");_DsMain.dispose();_DsMain=null;t=null;h.prop("selectedIndex",0)}function vt(){o.html("");o.append("<option value=0 ><\/option>");o.append("<option value=1 >Yes<\/option>");o.append("<option value=2 >No<\/option>");o.prop("selectedIndex",0)}function yt(){s.html("");s.append("<option value=0 ><\/option>");s.append("<option value=1 >Yes<\/option>");s.append("<option value=2 >No<\/option>");s.prop("selectedIndex",0)}function pt(){u.length==0&&(u.push({field:"SearchKey",caption:VIS.Msg.getMsg("VAWMS_SrchKey"),sortable:!1,size:"25%"}),u.push({field:"Locators",caption:VIS.Msg.getMsg("VAWMS_Locators"),sortable:!1,size:"20%"}),u.push({field:"Aisle",caption:VIS.Msg.getMsg("VAWMS_Aisle"),sortable:!1,size:"15%"}),u.push({field:"Bay",caption:VIS.Msg.getMsg("VAWMS_Bay"),sortable:!1,size:"20%"}),u.push({field:"ProductRow",caption:VIS.Msg.getMsg("VAWMS_ProdRow"),sortable:!1,size:"20%"}),u.push({field:"Position",caption:VIS.Msg.getMsg("VAWMS_Position"),sortable:!1,size:"10%",editable:{type:"text"}}),u.push({field:"Bin",caption:VIS.Msg.getMsg("VAWMS_Bin"),sortable:!1,size:"17%",editable:{type:"int"}}),u.push({field:"AvailableforAllo",caption:VIS.Msg.getMsg("VAWMS_AvailForAllo"),sortable:!1,size:"15%",editable:{type:"checkbox"}}),u.push({field:"AvailabletoProm",caption:VIS.Msg.getMsg("VAWMS_AvailToProm"),sortable:!1,size:"18%",editable:{type:"checkbox"}}),u.push({field:"Warehouse_ID",caption:VIS.Msg.getMsg("WareHouseID"),sortable:!1,size:"10%"}),u.push({field:"WareHouse",caption:VIS.Msg.getMsg("VAWMS_WareHouse"),sortable:!1,size:"10%"}),u.push({field:"locatorid",caption:VIS.Msg.getMsg("Locator_id"),sortable:!1,size:"10%"}));_LocatorsGrid.w2grid({name:"VAWMS_LocatorsGrid",recordHeight:25,columns:u,show:{selectColumn:!0},multiSelect:!1,onSelect:function(n){k=null;d=null;k=VIS.Utility.Util.getValueOfInt(w2ui.VAWMS_LocatorsGrid.records[VIS.Utility.Util.getValueOfInt(n.recid)-1].locatorid);d=w2ui.VAWMS_LocatorsGrid.records[VIS.Utility.Util.getValueOfInt(n.recid)-1].SearchKey}});w2ui.VAWMS_LocatorsGrid.hideColumn("Warehouse_ID");w2ui.VAWMS_LocatorsGrid.hideColumn("WareHouse");w2ui.VAWMS_LocatorsGrid.hideColumn("locatorid")}function wt(){i="";try{i+=" where ml.ad_client_id="+VIS.Env.getCtx().getAD_Client_ID()+" and ml.AD_ORG_ID="+VIS.Env.getCtx().getAD_Org_ID()+"";h.val()!="0"&&(i+=" And ml.m_warehouse_id="+VIS.Utility.Util.getValueOfInt(h.val()));g.val()!=""&&g.val().length>0&&(i+=" And ml.value='"+vtxtSearchKey.Text+"'");c.val()!=""&&c.val().length>0&&(i+=" And ml.locatorcombination='"+c.val()+"'");l.val()!=""&&l.val().length>0&&(i+=" And ml.x='"+l.val()+"'");a.val()!=""&&a.val().length>0&&(i+=" And ml.y='"+a.val()+"'");v.val()!=""&&v.val().length>0&&(i+=" And ml.z='"+v.val()+"'");p.val()!=""&&p.val().length>0&&(i+=" And ml.bin='"+p.val()+"'");y.val()!=""&&y.val().length>0&&(i+=" And ml.position='"+y.val()+"'");o.val()!="0"&&(o.val()=="1"&&(i+=" And ml.isavailabletopromise= 'Y'"),o.val()=="2"&&(i+=" And ml.isavailabletopromise= 'N'"));s.val()!="0"&&(s.val()=="1"&&(i+=" And ml.isavailableforallocation= 'Y'"),s.val()=="2"&&(i+=" And ml.isavailableforallocation= 'N'"))}catch(n){alert(n.message)}return i}function bt(){$BusyIndicator=t("<div>");$BusyIndicator.css({position:"absolute",bottom:"0",background:"url('"+VIS.Application.contextUrl+"Areas/VIS/Images/busy.gif') no-repeat","background-position":"center center",width:"98%",height:"98%","text-align":"center","z-index":"9999999"});$BusyIndicator[0].style.visibility="hidden";$Locator.append($BusyIndicator)}function kt(){w2ui.VAWMS_LocatorsGrid.destroy();n=null;$Locator=null;u=[];tt=null;h=null;it=null;g=null;rt=null;c=null;ut=null;l=null;ft=null;a=null;et=null;v=null;ot=null;y=null;st=null;p=null;ht=null;o=null;ct=null;s=null;nt=null;i=null;w=null;b=null;r=null;k=null;d=null}var tt=null,h=null,it=null,g=null,rt=null,c=null,ut=null,l=null,ft=null,a=null,et=null,v=null,ot=null,y=null,st=null,p=null,ht=null,o=null,ct=null,s=null,nt=null,i=null,w=[],u=[],b=0,r={},k=null,d=null,n,f;$Locator=t("<div>");n="";n="<div style='width:100%;float:left;margin-left:14px'>";n+="<div style='list-style:none;width:33.3%;float:left;'><label style='float:left;width:100%'  id='VAWMS_Loc_WHLabel'>Warehouse<\/label><select style='float:left;width:90%'  id='VAWMS_Loc_WHCombo'><\/select><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;'><label style='float:left;width:100%'  id='VAWMS_Loc_SrchKeyLabel'>Search Key<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_SrchKey'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;'><label style='float:left;width:100%'  id='VAWMS_Loc_LocLabel'>Locator<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Locator'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_AisleLabel'>Aisle<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Aisle'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_BayLabel'>Bay<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Bay'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_RowLabel'>Row<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Row'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_PositionLabel'>Position<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Position'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_BinLabel'>Bin<\/label><input type='text' style='float:left;width:90%'  id='VAWMS_Loc_Bin'/><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><label style='float:left;width:100%'  id='VAWMS_Loc_PromiseLabel'>Available To Promise<\/label><select type='text' style='float:left;width:90%'  id='VAWMS_Loc_Promise'><\/select><\/div>";n+="<div style='list-style:none;width:33.3%;margin-top:10px'><label style='float:left;margin-top: 5%;width:100%'  id='VAWMS_Loc_AllocationLabel'>Available To Promise<\/label><select type='text' style='float:left;width:90%'  id='VAWMS_Loc_Allocation'><\/select><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;margin-top:10px'><\/div>";n+="<div style='list-style:none;width:33.3%;float:left;><label style='width:100%;float:left;height:20px'> <\/label><input id='VAWMS_Loc_SrchBtn' type='button' value='Search' style='width:auto;float:right;font-weight:700;padding-right:20px;padding-left:20px' /><\/div>";n+="<div style='list-style:none;width:97%;float:left;margin-top:18px''><div id='VAWMS_Loc_Grid' style='height:200px'><\/div><\/div>";n+="<\/div>";$Locator.append(n);bt();lt();at();vt();yt();f=new VIS.ChildDialog;f.setContent($Locator);f.setTitle("Locator");f.setHeight(600);f.setWidth("70%");f.setEnableResize(!1);f.setModal(!0);f.show();pt();nt.click(function(){var t,n;$BusyIndicator[0].style.visibility="visible";b=0;t=" SELECT ml.m_warehouse_id as warehouseID, mw.name as Warehouse, ml.value  as searchKey, ml.locatorcombination as Locators, ml.x as Aisle ,ml.y as Bay ,  ml.z   as ProductRow , ml.position  as Position ,  ml.bin  as Bin , ml.isavailableforallocation as availableforallocation, ml.isavailabletopromise as availabletopromise,ml.m_locator_id  FROM m_locator ml JOIN m_warehouse mw on ml.m_warehouse_id= mw.m_warehouse_id "+wt();try{if(_DsMain=VIS.DB.executeDataSet(t.toString(),null),t=null,w=[],w2ui.VAWMS_LocatorsGrid.clear(),_DsMain!=null){for(n=0;n<_DsMain.tables[0].rows.length;n++)r={},b=b+1,r.Warehouse_ID=_DsMain.tables[0].rows[n].cells.warehouseid,r.WareHouse=_DsMain.tables[0].rows[n].cells.warehouse,r.SearchKey=_DsMain.tables[0].rows[n].cells.searchkey,r.Locators=_DsMain.tables[0].rows[n].cells.locators,r.Aisle=_DsMain.tables[0].rows[n].cells.aisle,r.Bay=VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.bay),r.ProductRow=VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.productrow),r.Position=VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.position),r.Bin=VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.bin),r.locatorid=VIS.Utility.Util.getValueOfInt(_DsMain.tables[0].rows[n].cells.m_locator_id),r.AvailableforAllo=VIS.Utility.Util.getValueOfBoolean(_DsMain.tables[0].rows[n].cells.availableforallocation),r.AvailabletoProm=VIS.Utility.Util.getValueOfBoolean(_DsMain.tables[0].rows[n].cells.availabletopromise),r.recid=b,w.push(r);w2utils.encodeTags(w);w2ui.VAWMS_LocatorsGrid.add(w)}_DsMain.dispose();_DsMain=null}catch(i){alert(i.message);$BusyIndicator[0].style.visibility="hidden"}$BusyIndicator[0].style.visibility="hidden"});f.onOkClick=function(){if(k==null||d==null)return VIS.ADialog.info(VIS.Msg.getMsg("VAMFG_NoRecordSelected"),null,"",""),!1;e.attr("key","");e.val("");e.attr("key",k);e.val(d)};f.onCancelCLick=function(){};f.onClose=function(){kt()}}function gr(){var r,n,t;if(r=f,i="",i="Select M_Warehouse_ID,Name from m_warehouse where IsWMSEnabled='Y' AND Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+" order by name",n=VIS.DB.executeDataSet(i.toString(),null),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)f.append("<option value="+VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.m_warehouse_id)+">"+n.tables[0].rows[t].cells.name+"<\/option>");n.dispose();f.prop("selectedIndex",1)}function nu(){return w2ui["WaveGrid"+$Self.windowNo].records.length<=0?"VAMFG_NoRecordsFound":w.is(":checked")&&(e.attr("Key")==0||e.attr("Key")==null)?"VAMFG_SlctStagingLoc":p.val()==0||p.val()==null?"VAMFG_SlctTasType":ut.val()==0||ut.val()==null?"VAMFG_SlctDocAction":u.val()==0||u.val()==null?"VAMFG_WrkOrdFllRule":"OK"}function tu(){return f.val()==0||f.val()==null?"VAMFG_SlctWarehouse":"OK"}function iu(){var r=o,n,t;if(i="",i="select VAWMS_name as name, VAWMS_c_doctypegroup_id as value  from vawms_c_doctypegroup where Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+" order by VAWMS_name",n=VIS.DB.executeDataSet(i.toString(),null),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)o.append("<option value="+VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.value)+">"+n.tables[0].rows[t].cells.name+"<\/option>");n.dispose();o.prop("selectedIndex",1)}function ru(){var n,t;if(bt=!1,i="",i="SELECT wo.vamfg_m_workorder_id || '_' || mp.NAME as name, wo.vamfg_m_workorder_id as Value FROM vamfg_m_workorder wo  inner join m_product mp on wo.m_product_id = mp.m_product_id  WHERE docstatus IN ('IP') AND EXISTS (SELECT 1 FROM vamfg_M_WorkOrderOperation woo WHERE woo.vamfg_M_WorkOrder_ID = wo.vamfg_M_WorkOrder_ID AND EXISTS (SELECT 1 FROM vamfg_M_WorkOrderComponent woc WHERE woc.vamfg_M_WorkOrderOperation_ID = woo.vamfg_M_WorkOrderOperation_ID AND woc.vamfg_QtyDedicated + woc.vamfg_QtyAllocated + woc.vamfg_QtyAvailable<woc.vamfg_QtyRequired * wo.vamfg_QtyEntered AND woc.vamfg_SupplyType ='P')) AND wo.Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND wo.AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"",n=VIS.DB.executeDataSet(i.toString(),null),a.append("<option value=0 ><\/option>"),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)a.append("<option value="+VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.value)+">"+n.tables[0].rows[t].cells.name+"<\/option>");bt=!0}function uu(){var n,t;if(kt=!1,i="",i="select vamfg_name, vamfg_m_workcenter_id as value from vamfg_m_workcenter where Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"   order by vamfg_name",n=VIS.DB.executeDataSet(i.toString(),null),v.append("<option value=0 ><\/option>"),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)v.append("<option value="+VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.value)+">"+n.tables[0].rows[t].cells.vamfg_name+"<\/option>");kt=!0}function fu(){var f,e,u,r,t,n;if(gt=!1,f="VAMFG_M_WorkOrder,VAMFG_WOType",e=VIS.dataContext.getJSONRecord("MF_Constants/GetMFConstants",f.toString()),i="",i="SELECT ad_reference_value_id FROM ad_column WHERE ad_column_id="+e,u=0,r=VIS.DB.executeDataSet(i.toString(),null),r!=null&&r.tables[0].rows.length>0)for(n=0;n<r.tables[0].rows.length;n++)u=VIS.Utility.Util.getValueOfInt(r.tables[0].rows[n].cells.ad_reference_value_id);if(VIS.Env.isBaseLanguage(VIS.Env.getCtx(),"AD_Ref_List")==!0?(i="",i="SELECT Value, Name FROM AD_Ref_List WHERE AD_Reference_ID="+u+" AND IsActive='Y'"):(i="",i="SELECT AD_Ref_List.Value as value, t.Name as name FROM AD_Ref_List, AD_Ref_List_Trl t WHERE AD_Ref_List.AD_Ref_List_ID=t.AD_Ref_List_ID AND t.AD_Language='"+VIS.Envs.GetAD_Language(VIS.Envs.GetContext())+"' AND AD_Ref_List.AD_Reference_ID="+u+" AND AD_Ref_List.IsActive='Y'"),t=VIS.DB.executeDataSet(i.toString(),null),t!=null&&(ft.append("<option value=0 ><\/option>"),t.tables[0].rows.length>0))for(n=0;n<t.tables[0].rows.length;n++)ft.append("<option value="+t.tables[0].rows[n].cells.value+">"+t.tables[0].rows[n].cells.name+"<\/option>");gt=!0}function eu(){var r=0,u=VIS.dataContext.getJSONRecord("MF_Constants/GetMFConstants","C_Order,PriorityRule".toString()),n,t;if(i="",i="SELECT ad_reference_value_id FROM ad_column WHERE ad_column_id="+u,n=VIS.DB.executeDataSet(i.toString(),null),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)r=VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.ad_reference_value_id);if(i="",i="select name, value from ad_ref_list where ad_reference_id = "+r,n=null,n=VIS.DB.executeDataSet(i.toString(),null),n!=null&&(y.append("<option value=0 ><\/option>"),n.tables[0].rows.length>0))for(t=0;t<n.tables[0].rows.length;t++)y.append("<option value="+n.tables[0].rows[t].cells.value+">"+n.tables[0].rows[t].cells.name+"<\/option>");fr=!0}function ou(){if(dt=!1,i="",i=" select VAMFG_NAME as name, VAMFG_c_wavesortcriteria_id as VALUE from VAMFG_c_wavesortcriteria where VAMFG_docbasetype = 'WOO' AND  Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"  ",dr=VIS.DB.executeDataSet(i.toString(),null),dr!=null){if(et.append("<option value=0 ><\/option>"),dr.tables[0].rows.length>0)for(var n=0;n<dr.tables[0].rows.length;n++)et.append("<option value="+dr.tables[0].rows[n].cells.value+">"+dr.tables[0].rows[n].cells.name+"<\/option>");dt=!0}}function su(){if(ni=!1,i="",i="select VAWMS_name as name, VAWMS_zone_id as value from VAWMS_zone where Ad_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"  ORDER by VAWMS_name",dr=VIS.DB.executeDataSet(i.toString(),null),dr!=null){if(d.append("<option value=0 ><\/option>"),dr.tables[0].rows.length>0)for(var n=0;n<dr.tables[0].rows.length;n++)d.append("<option value="+dr.tables[0].rows[n].cells.value+">"+dr.tables[0].rows[n].cells.name+"<\/option>");ni=!0}}function hu(){if(i="",i="select name, value from ad_ref_list where ad_reference_id=151 and AD_Ref_List.Value IN ('A','L','O')",dr=VIS.DB.executeDataSet(i.toString(),null),dr!=null){if(u.append("<option value=0 ><\/option>"),dr.tables[0].rows.length>0)for(var n=0;n<dr.tables[0].rows.length;n++)u.append("<option value="+dr.tables[0].rows[n].cells.value+">"+dr.tables[0].rows[n].cells.name+"<\/option>");ur=!0}}function cu(){if(dr=VIS.DB.executeDataSet("select name, c_doctype_id from c_doctype where docbasetype='PCK'",null),dr!=null){if(p.append("<option value=0 ><\/option>"),dr.tables[0].rows.length>0)for(var n=0;n<dr.tables[0].rows.length;n++)p.append("<option value="+dr.tables[0].rows[n].cells.c_doctype_id+">"+dr.tables[0].rows[n].cells.name+"<\/option>");er=!0}}function lu(){var n=VIS.dataContext.getJSONRecord("MF_ValueNamePair/PickOrder"),t;if(n!=null&&n.length>0)for(t=0;t<n.length;t++)lt.append("<option value="+n[t].Name+">"+n[t].Key+"<\/option>")}function au(){if(dr=VIS.DB.executeDataSet("select name, value from ad_ref_list where ad_reference_id=135 and AD_Ref_List.Value IN ('PR','CO') order by name desc",null),dr!=null){if(dr.tables[0].rows.length>0)for(var n=0;n<dr.tables[0].rows.length;n++)ti.append("<option value="+dr.tables[0].rows[n].cells.value+">"+dr.tables[0].rows[n].cells.name+"<\/option>");rr=!0}}function vt(n){return n?"#FFB6C1":"White"}function vu(){return r=" ",f.val()!=0&&f.val()!=null&&(r=r.toString().concat("WHERE  wo.M_Warehouse_ID = "+f.val())),ct!=null&&(r=r+r.toString().concat("AND bp.C_Bpartner_ID = "+ct)),ht!=null&&(r=r.toString().concat(" AND mp.M_Product_ID = "+ht)),a.val()!=0&&a.val()!=null&&(r=r.toString().concat(" AND wo.VAMFG_M_Workorder_ID = "+a.val())),VIS.Utility.Util.getValueOfInt(nt.val())!=0&&VIS.Utility.Util.getValueOfInt(tt.val())!=0&&(r=r.toString().concat(" AND woo.VAMFG_SeqNo > "+VIS.Utility.Util.getValueOfInt(nt.val())+" And woo.VAMFG_SeqNo < "+VIS.Utility.Util.getValueOfInt(tt.val()))),y.val()!=0&&y.val()!=null&&(r=r.toString().concat(" AND wo.VAMFG_PriorityRule = "+y.val())),v.val()!=0&&v.val()!=null&&(r=r.toString().concat(" AND mwc.vamfg_M_WorkCenter_ID = "+v.val())),o.val()!=0&&o.val()!=null&&(r=r.toString().concat(" AND cdtg.vawms_C_DOCTYPEGROUPLINE_ID = "+o.val())),(s.val()!=null||h.val()!=null)&&(s.val()==""&&h.val()!=""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD')<=to_date('"+h.val()+"','YYYY-MM-DD')"),s.val()!=""&&h.val()==""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD')>=to_date('"+s.val()+"','YYYY-MM-DD')"),s.val()!=""&&h.val()!=""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD') Between to_date('"+s.val()+"','YYYY-MM-DD') And to_date('"+h.val()+"','YYYY-MM-DD')")),(c.val()!=null||l.val()!=null)&&(c.val()==""&&l.val()!=""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD')<=to_date('"+l.val()+"','YYYY-MM-DD')"),c.val()!=""&&l.val()==""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD')>=to_date('"+c.val()+"','YYYY-MM-DD')"),c.val()!=""&&l.val()!=""&&(r+=" And TRUNC(wo.vamfg_dateschedulefrom,'DD') Between to_date('"+c.val()+"','YYYY-MM-DD') And to_date('"+l.val()+"','YYYY-MM-DD')")),at==!0&&(r=r.toString().concat(" AND wo.DOCSTATUS='IP'")),r.toString()}function sr(n){var t={},i=[];t.ProcessRows=b.val();t.Warehouse=f.val();t.SourceZone=d.val();t.FullFilmentRule=u.val();t.GeneratePL=w.is(":checked");t.PrintPL=k.is(":checked");t.SupervisedOper=st.is(":checked");t.OrderTypeGroup=o.val();t.PickMethod=lt.val();t.ClusterSize=rt.val();t.StagingLocator=e.attr("Key");t.TaskType=p.val();t.DocAction=ut.val();i.push(t);hr.ProcessTask(n,i,yu)}function yu(n){if(n!=null){var t=jQuery.parseJSON(n);t.res=="Success"?($BusyIndicator[0].style.visibility="hidden",VIS.ADialog.info(VIS.Msg.getMsg(t.res.toString()),null,"",""),ir()):($BusyIndicator[0].style.visibility="hidden",VIS.ADialog.info(VIS.Msg.getMsg(t.res.toString()),null,"",""),ir())}else $BusyIndicator[0].style.visibility="hidden",VIS.ADialog.info(t.res.toString(),null,"","")}function ir(){w2ui["WaveGrid"+$Self.windowNo].clear();e.val("");a.val(0);$ProductControl.setValue();$BPartnerCntrl.setValue();v.val(0);ft.val(0);y.val(0);et.val(0);d.val(0);u.val(0);p.val(0);nt.val("");tt.val("");rt.val("");b.val("");s.val("");h.val("");c.val("");l.val("");u.css("background-color",vt(!0))}function pu(){ii.Text=VIS.Msg.getMsg("VAMFG_WarehouseLbl");ri.Text=VIS.Msg.getMsg("VAMFG_WOTypeLbl");ui.Text=VIS.Msg.getMsg("VAMFG_WOLabel");fi.Text=VIS.Msg.getMsg("VAMFG_Productlbl");ei.Text=VIS.Msg.getMsg("VAMFG_OpertSeqLbl");oi.Text=VIS.Msg.getMsg("VAMFG_WorkCenterlbl");si.Text=VIS.Msg.getMsg("VAMFG_BPartnerlbl");hi.Text=VIS.Msg.getMsg("VAMFG_OpertnlSheduledDateFromLbl");ci.Text=VIS.Msg.getMsg("VAMFG_OpertnlSheduledDateToLbl");li.Text=VIS.Msg.getMsg("VAMFG_PriorityLbl");ai.Text=VIS.Msg.getMsg("VAMFG_WrkOrdrTypeLbl");vi.Text=VIS.Msg.getMsg("VAMFG_WrkOrdrSrtCrytLbl");g.value=VIS.Msg.getMsg("VAMFG_SearchBtn");yi.Text=VIS.Msg.getMsg("VAMFG_ProcessRowLbl");pi.Text=VIS.Msg.getMsg("VAMFG_SourceZoneLbl");wi.Text=VIS.Msg.getMsg("VAMFG_WrkOrdrFullRuleLbl");bi.Text=VIS.Msg.getMsg("VAMFG_PickMethodLbl");ki.Text=VIS.Msg.getMsg("VAMFG_ClusterSizeLbl");di.Text=VIS.Msg.getMsg("VAMFG_TaskTypeLbl");gi.Text=VIS.Msg.getMsg("VAMFG_MLocatorLbl");nr.Text=VIS.Msg.getMsg("VAMFG_DocActionLbl");tr.value=VIS.Msg.getMsg("VAMFG_ProcessBtn")}function wu(){$BusyIndicator=t("<div>");$BusyIndicator.css({position:"absolute",bottom:"0",background:"url('"+VIS.Application.contextUrl+"Areas/VIS/Images/busy.gif') no-repeat","background-position":"center center",width:"98%",height:"98%","text-align":"center","z-index":"9999999"});$BusyIndicator[0].style.visibility="hidden";n.append($BusyIndicator)}var n,hr;this.windowNo;$Self=this;n=t("<div/>");this.frame;var yt=null,ht=null,pt=null,ct=null,f=null,wt=null,o=null,cr=[],rt=null,w=null,b=null,k=null,bt=!0,kt=!0,dt=!0,ut=null,gt=!0,ni=!0,rr=!0,ur=!0,i=null,fr=!1,a=null,v=null,ft=null,y=null,et=null,d=null,ot=null,lt=null,u=null,lr=null,p=null,er=!0,g=null,ti=null,nt=null,tt=null,s=null,h=null,c=null,l=null,st=null,at=!1,e=null,r=" ",it=null,or=[],ii=null,ri=null,ui=null,fi=null,ei=null,oi=null,si=null,hi=null,ci=null,li=null,ai=null,vi=null,yi=null,pi=null,wi=null,bi=null,ki=null,di=null,gi=null,nr=null,tr=null;this.Initialize=function(){var i,n,t;if(i="select COUNT(*)  as value from ad_moduleinfo where prefix='VAWMS_'",n=VIS.DB.executeDataSet(i.toString(),null),n!=null&&n.tables[0].rows.length>0)for(t=0;t<n.tables[0].rows.length;t++)VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.value)!=0?ar():VIS.ADialog.info("VAWMS_InstallWarehouseModuleFirst",null,"","")};this.getRoot=function(){return n};this.disposeComponent=function(){n=null;$Self=null;yt=null;ht=null;pt=null;ct=null;f=null;wt=null;o=null;cr=[];rt=null;w=null;b=null;k=null;bt=!0;kt=!0;dt=!0;ut=null;gt=!0;ni=!0;rr=!0;ur=!0;i=null;fr=!1;a=null;v=null;ft=null;y=null;et=null;d=null;ot=null;lt=null;u=null;lr=null;p=null;er=!0;g=null;ti=null;nt=null;tt=null;s=null;h=null;c=null;l=null;st=null;at=!1;e=null;r=" ";it=null;or=[];it=null;or=[];ii=null;ri=null;ui=null;fi=null;ei=null;oi=null;si=null;hi=null;ci=null;li=null;ai=null;vi=null;yi=null;pi=null;wi=null;bi=null;ki=null;di=null;gi=null;nr=null;tr=null};this.Grid_Layout=function(){var n=[];n.length==0&&(n.push({field:"ProductName",caption:VIS.Msg.getMsg("VAMFG_PrductAsmbly"),sortable:!0,size:"20%"}),n.push({field:"WorkOrderNo",caption:VIS.Msg.getMsg("VAMFG_WrkOrdrno"),sortable:!0,size:"20%"}),n.push({field:"DateFrom",caption:VIS.Msg.getMsg("VAMFG_DateFrm"),sortable:!0,size:"20%"}),n.push({field:"DateTo",caption:VIS.Msg.getMsg("VAMFG_DateTo"),sortable:!0,size:"20%"}),n.push({field:"WorkOrderOperation",caption:VIS.Msg.getMsg("VAMFG_WrkOrdrOpertn"),sortable:!0,size:"20%"}));wt.w2grid({name:"WaveGrid"+$Self.windowNo,recordHeight:25,columns:n,method:"GET",show:{selectColumn:!0}})};hr={ProcessTask:function(n,i,r){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VAMFG/ProcessData/CallProcess",contentType:"application/json",data:JSON.stringify({GetGridData:n,Param:i}),success:function(n){r(n)}})}}}i.prototype.dispose=function(){w2ui["WaveGrid"+$Self.windowNo].destroy();this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null};i.prototype.init=function(n,t){this.windowNo=n;this.frame=t;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.Grid_Layout()};n.CMFG=n.CMFG||{};n.CMFG.Server=n.CMFG.Server||{};n.CMFG.Server.Window=n.CMFG.Server.Window||{};n.CMFG.Server.Window.WavePlanningWindowImp=i}(VAMFG,jQuery);VAMFG=window.VAMFG||{},function(n,t){function i(){function ai(){t("#VAMFG_LblProd_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Product"));t("#VAMFG_LblInvoice_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Invoice"));t("#VAMFG_LblOrder_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Order"));t("#VAMFG_LblProject_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Project"));t("#VAMFG_LblQty_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Qty"));t("#VAMFG_OkButton_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Ok"));t("#VAMFG_CancelButton_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Cancel"));t("#VAMFG_LblRequisition_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Requisition"));t("#VAMFG_LblDocStatus_"+$self.windowNo+"").text(VIS.Msg.parseTranslation(VIS.Env.getCtx(),"DocStatus"));t("#VAMFG_LblAttributeSetInstance_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_AttributeSetInstance"));t("#VAMFG_LblBOM_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_BOM"));t("#VAMFG_PrintButton_"+$self.windowNo+"").text(VIS.Msg.getMsg("VAMFG_Print"))}function vi(n){return VIS.dataContext.getJSONRecord("BOMDrop/GetWindow_ID",n.toString())}function yi(t){if(c.empty(),n=VIS.dataContext.getJSONRecord("BOMDrop/GetBOM",t.toString()),n!=null&&n.length>0){c.append("<option value=0><\/option>");for(var i=0;i<n.length;i++)c.append("<option value="+VIS.Utility.encodeText(VIS.Utility.Util.getValueOfInt(n[i].M_BOM_ID))+">"+VIS.Utility.encodeText(n[i].Name)+"<\/option>");n=null;c.prop("selectedIndex",0)}}function pi(){VIS.Utility.Util.getValueOfInt(h.val())&&c.val()?(VIS.Env.getCtx().setWindowContext($self.windowNo,"M_Product_ID",h.val()),VIS.Env.getCtx().setWindowContext($self.windowNo,"M_Product_ID",c.val()),yt.GetBomLines(VIS.Env.getCtx().getAD_Client_ID(),VIS.Env.getCtx().getAD_Org_ID(),c.val(),ki)):(u[0].style.visibility="hidden",w2ui["VAMFG_BomGrid_"+$self.windowNo].clear())}function fi(){if(h.empty(),n=VIS.DB.executeDataSet("SELECT M_Product_ID, Value||'_'||Name AS Name  FROM M_Product WHERE IsBOM ='Y' AND IsVerified='Y' AND IsActive  ='Y' AND AD_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID IN ("+VIS.Env.getCtx().getAD_Org_ID()+",0) ORDER BY Name",null),n!=null&&n.tables[0].rows.length>0){h.append("<option value=0><\/option>");for(var t=0;t<n.tables[0].rows.length;t++)h.append("<option value="+VIS.Utility.encodeText(VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.m_product_id))+">"+VIS.Utility.encodeText(n.tables[0].rows[t].cells.name)+"<\/option>");n.dispose();n=null;h.prop("selectedIndex",0)}}function ei(){if(e.empty(),n=VIS.DB.executeDataSet("SELECT C_Order_ID, DocumentNo || '_' || GrandTotal as Name  FROM C_Order WHERE Processed='N' AND DocStatus='DR' AND C_DOCTYPETARGET_ID in (select C_DOCTYPE_ID from C_DOCTYPE where DOCBASETYPE in ('SOO','POO') AND IsReleaseDocument='N' AND IsBlanketTrx='N' )  AND IsReturnTrx='N' AND AD_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+" ORDER BY DocumentNo",null),n!=null&&n.tables[0].rows.length>0){e.append("<option value=0><\/option>");for(var t=0;t<n.tables[0].rows.length;t++)e.append("<option value="+VIS.Utility.encodeText(VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.c_order_id))+">"+VIS.Utility.encodeText(n.tables[0].rows[t].cells.name)+"<\/option>");n.dispose();n=null;e.prop("selectedIndex",0)}}function oi(){if(o.empty(),n=VIS.DB.executeDataSet("SELECT C_Project_ID, Name  FROM C_Project   WHERE Processed='N' AND IsSummary='N' AND IsActive='Y'  AND ProjectCategory<>'S'   AND AD_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"  ORDER BY Name",null),n!=null&&n.tables[0].rows.length>0){o.append("<option value=0><\/option>");for(var t=0;t<n.tables[0].rows.length;t++)o.append("<option value="+VIS.Utility.encodeText(VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.c_project_id))+">"+VIS.Utility.encodeText(n.tables[0].rows[t].cells.name)+"<\/option>");n.dispose();n=null;o.prop("selectedIndex",0)}}function si(){if(f.empty(),n=VIS.DB.executeDataSet("SELECT C_Invoice_ID, DocumentNo || '_' || GrandTotal as Name  FROM C_Invoice WHERE Processed='N' AND DocStatus='DR'   AND AD_Client_ID="+VIS.Env.getCtx().getAD_Client_ID()+" AND AD_Org_ID="+VIS.Env.getCtx().getAD_Org_ID()+"  ORDER BY DocumentNo",null),n!=null&&n.tables[0].rows.length>0){f.append("<option value=0><\/option>");for(var t=0;t<n.tables[0].rows.length;t++)f.append("<option value="+VIS.Utility.encodeText(VIS.Utility.Util.getValueOfInt(n.tables[0].rows[t].cells.c_invoice_id))+">"+VIS.Utility.encodeText(n.tables[0].rows[t].cells.name)+"<\/option>");n.dispose();n=null;f.prop("selectedIndex",0)}}function vt(){if(s.empty(),dr=VIS.dataContext.getJSONRecord("BOMDrop/GetRequisitions"),dr!=null){s.append("<option value=0><\/option>");for(var n=0;n<dr.length;n++)s.append("<option value="+VIS.Utility.encodeText(dr[n].M_Requisition_ID)+">"+VIS.Utility.encodeText(dr[n].DocumentNo)+"<\/option>")}}function wi(){l.empty();VIS.dataContext.getJSONData(VIS.Application.contextUrl+"BOMDrop/GetDocStatus",null,bi)}function bi(n){if(n!=null){l.append("<option value=0><\/option>");for(var t=0;t<n.length;t++)l.append("<option value="+n[t].Value+">"+n[t].Name+"<\/option>")}}function ki(n){if(w2ui["VAMFG_BomGrid_"+$self.windowNo].clear(),n!=null){var t=jQuery.parseJSON(n);t!=null&&gi(t.Res)}u[0].style.visibility="hidden"}function di(n){if(k=[],n!=null){var t=jQuery.parseJSON(n);t.Res=="Save"?alert("Bom Drop Successful"):t.Res=="NotSaved"?alert("Bom Drop UnSuccessful"):alert(t.Res);hi();u[0].style.visibility="hidden"}else u[0].style.visibility="hidden"}function gi(n){var f=VIS.Utility.Util.getValueOfDecimal(y.val()),r=0,i,t;for(b=[],i=0;i<n.length;i++)tt=!1,it=!1,r=i+1,t=n[i],t.StandardProdType==t.BomType&&(tt=!0),t.OptionalProdType==t.BomType&&(it=!0),a={},tt?a.ProdType=!0:it&&(a.ProdType=!1),a.recid=r,a.Product=t.Name,a.Product_ID=t.M_Product_ID,a.Qty=VIS.Utility.Util.getValueOfDecimal(t.BomQty)*f,a.StaticQty=VIS.Utility.Util.getValueOfDecimal(t.BomQty),a.AttributeSetInstance=t.AttributeSetInstance,a.AttributeSetInstance_ID=VIS.Utility.Util.getValueOfInt(t.M_AttributeSetInstance_ID),b.push(a);w2utils.encodeTags(b);w2ui["VAMFG_BomGrid_"+$self.windowNo].add(b);u[0].style.visibility="hidden"}function nr(n){if(w2ui["VAMFG_BomGrid_"+$self.windowNo].records.length>0){for(var t=0;t<w2ui["VAMFG_BomGrid_"+$self.windowNo].records.length;t++)w2ui["VAMFG_BomGrid_"+$self.windowNo].records[t].Qty=VIS.Utility.Util.getValueOfDecimal(w2ui["VAMFG_BomGrid_"+$self.windowNo].records[t].StaticQty)*n;w2ui["VAMFG_BomGrid_"+$self.windowNo].refresh();u[0].style.visibility="hidden"}else u[0].style.visibility="hidden"}function tr(){var n={},i,t;if(g=w2ui["VAMFG_BomGrid_"+$self.windowNo].getSelection(),g.length>0){for(i=0;i<g.length;i++)t=w2ui["VAMFG_BomGrid_"+$self.windowNo].records[g[i]-1],n={},t.ProdType==!0&&(n.M_Product_ID=t.Product_ID,n.M_AttributeSetInstance_ID=t.AttributeSetInstance_ID,n.Qty=t.Qty,k.push(n));k.length>0?yt.ProcessBomLines(VIS.Utility.Util.getValueOfInt(f.val()),VIS.Utility.Util.getValueOfInt(e.val()),VIS.Utility.Util.getValueOfInt(o.val()),VIS.Utility.Util.getValueOfInt(s.val()),l.val(),k,di):(alert("No Row Selected"),u[0].style.visibility="hidden")}else alert("No Row Selected"),u[0].style.visibility="hidden"}function hi(){w2ui["VAMFG_BomGrid_"+$self.windowNo].clear();vt();h.prop("selectedIndex",0);e.prop("selectedIndex",0);f.prop("selectedIndex",0);o.prop("selectedIndex",0);s.prop("selectedIndex",0);c.prop("selectedIndex",0);p.setValue(null);y.val(1);e.prop("disabled",!1);f.prop("disabled",!1);o.prop("disabled",!1);s.prop("disabled",!1);l.prop("selectedIndex",0);w.hide();l.hide();b=[];k=[]}function ir(){u=t("<div>");u.css({position:"absolute",bottom:"0",background:"url('"+VIS.Application.contextUrl+"Areas/VIS/Images/busy.gif') no-repeat","background-position":"center center",width:"98%",height:"98%","text-align":"center","z-index":"9999999"});u[0].style.visibility="hidden";r.append(u)}var ui,yt,g;this.windowNo;this.frame;$self=this;var r=t("<div/>"),pt=null,h=null,wt=null,f=null,bt=null,e=null,kt=null,o=null,dt=null,y=null,d=null,ht=null,ct=null,gt=null,s=null,ni=null,nt=null,ti=null,c=null,w=null,l=null,p=null,ii=null,n=null,ci=null,v=[],tt=!1,it=!1,b=[],a={},k=[],u=null,li,ri,lt=null,rt=null,ut=null,ft=null,et=null,ot=null,st=null,at=null;this.Initialize=function(){t.ajax({url:VIS.Application.contextUrl+"VAMFG/BOMDrop/Index",type:"Get",async:!1,data:{windowno:$self.windowNo},success:function(n){ii=new VIS.MPAttributeLookup(VIS.context,$self.windowNo);p=new VIS.Controls.VPAttribute("M_AttributeSetInstance_ID",!1,!1,!0,VIS.DisplayType.PAttribute,ii,$self.windowNo,!1,!1,!1,!0);ri=VIS.MLookupFactory.get(VIS.Env.getCtx(),$self.windowNo,8472,VIS.DisplayType.Search,"M_AttributeSetInstance_ID",0,!1,"");li=new VIS.Controls.VTextBoxButton("M_AttributeSetInstance_ID",!1,!1,!0,VIS.DisplayType.Search,ri);p.setReadOnly(!0);n!=null&&(r=t(n),ir())},error:function(n){alert(n)}})};this.LoadRoot=function(){function b(){var n=t("<ul class='vis-apanel-rb-ul'>");return n.append(t("<li data-action='Z'><Img data-action='Z' src="+VIS.Application.contextUrl+"Areas/VIS/Images/Zoom16.png>")),n.append(t("<li data-action='R'><Img data-action='R' src="+VIS.Application.contextUrl+"Areas/VIS/Images/Refresh16.png>")),n}function k(){var t=new VIS.Query,i;t.addRestriction(n,VIS.Query.prototype.EQUAL,a);(n=="C_Order_ID"||n=="C_Invoice_ID")&&(v=g(n,a));i=vi(v);VIS.viewManager.startWindow(i,t)}function g(n,t){var i=null,e=n.toString().concat(",",t.toString()),f=VIS.dataContext.getJSONRecord("BOMDrop/GetTrxType",e),r,u;return f!=null&&(r=f.IsSoTrx,u=f.IsReturnTrx,r=="Y"&&u=="N"&&n=="C_Order_ID"&&(i="Sales Order"),r=="Y"&&u=="Y"&&n=="C_Order_ID"&&(i="Customer Return"),r=="N"&&u=="N"&&n=="C_Order_ID"&&(i="Purchase Order"),r=="N"&&u=="Y"&&n=="C_Order_ID"&&(i="Return To Vendor"),r=="Y"&&u=="N"&&n=="C_Invoice_ID"&&(i="Invoice (Customer)"),r=="N"&&u=="N"&&n=="C_Invoice_ID"&&(i="Invoice (Vendor)")),i}function tt(n){var t=VIS.dataContext.getJSONRecord("BOMDrop/GetAttributeSet",n.toString());t!=null&&p.setValue(t.Name);t=null;nt.prop("selectedIndex",0)}var i;u[0].style.visibility="visible";pt=r.find("#VAMFG_LblProd_"+$self.windowNo);h=r.find("#VAMFG_CmbProd_"+$self.windowNo);wt=r.find("#VAMFG_LblInvoice_"+$self.windowNo);f=r.find("#VAMFG_CmbInvoice_"+$self.windowNo);bt=r.find("#VAMFG_LblOrder_"+$self.windowNo);e=r.find("#VAMFG_CmbOrder_"+$self.windowNo);kt=r.find("#VAMFG_LblProject_"+$self.windowNo);o=r.find("#VAMFG_CmbProject_"+$self.windowNo);dt=r.find("#VAMFG_LblQty_"+$self.windowNo);y=r.find("#VAMFG_Qty_"+$self.windowNo);d=r.find("#VAMFG_BOMGrid_"+$self.windowNo);ht=r.find("#VAMFG_OkButton_"+$self.windowNo);ct=r.find("#VAMFG_CancelButton_"+$self.windowNo);gt=r.find("#VAMFG_LblRequisition_"+$self.windowNo);s=r.find("#VAMFG_RequisitionCmb_"+$self.windowNo);w=r.find("#VAMFG_LblDocStatus_"+$self.windowNo);l=r.find("#VAMFG_DocStatusCmb_"+$self.windowNo);lt=r.find("#VAMFG_btnRefresh_"+$self.windowNo).css({"background-image":"url('"+VIS.Application.contextUrl+"Areas/VIS/Images/base/Refresh24.png')"});ni=r.find("#VAMFG_LblAttributeSetInstance_"+$self.windowNo);nt=r.find("#VAMFG_AttributeSetInstanceCmb_"+$self.windowNo);ti=r.find("#VAMFG_LblBOM_"+$self.windowNo);c=r.find("#VAMFG_CmbBOM_"+$self.windowNo);nt.append(t(p.getControl()).css({width:"calc(100% - 35px)",float:"left"})).append(t(p.getBtn(0)).css({float:"left",width:"31px",padding:"0"}));rt=r.find(".VAMFG-info-btn-Prod");ut=r.find(".VAMFG-info-btn-Inv");ft=r.find(".VAMFG-info-btn-Ord");et=r.find(".VAMFG-info-btn-Prj");ot=r.find(".VAMFG-info-btn-Req");st=r.find(".VAMFG-info-btn-BOM");at=r.find("#VAMFG_PrintButton_"+$self.windowNo);y.val(1);w.hide();l.hide();fi();ei();si();oi();vt();wi();h.change(function(){yi(h.val())});c.change(function(){tt(c.val());pi()});at.on("click",function(){var r,n,i,f,o;if(w2ui["VAMFG_BomGrid_"+$self.windowNo]==null,u[0].style.visibility="visible",r=w2ui["VAMFG_BomGrid_"+$self.windowNo],r.records.length>0){var s=t('[id^="VAMFG_CmbProd_"]')[0].selectedOptions[0].innerText,h=t('[id^="VAMFG_CmbBOM_"]')[0].selectedOptions[0].innerText,c=t('[id^="VAMFG_Qty_"]').val(),e=t('[id^="VAMFG_AttributeSetInstanceCmb_"]')[0].children[0].value.substring(1,t('[id^="VAMFG_AttributeSetInstanceCmb_"]')[0].children[0].value.length-1);for((e==null||e=="")&&(e="&nbsp;"),n="<div style='float: left;width: 100%; border: 1px solid #000;margin-top: 50px; margin-bottom: 20px;'><div style='float: left;width: 100%;text-align: center; padding: 10px 0;'><h4 style='margin: 0;font-size: 20px;'>"+VIS.Msg.getMsg("VAMFG_ProductBOMComponents")+"<\/h4><\/div><div style=' float: left; width: 100%; border-top: 1px solid #000; border-bottom: 1px solid #000;display: flex;'><div class='table-col' style=' float: left;  width: 30%; border-right: 1px solid #000;box-sizing: border-box;padding: 10px 0;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("Product")+"<\/h5><\/div><div class='table-col' style='float: left;width: 30%;border-right: 1px solid #000;box-sizing: border-box;padding: 10px 0;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_BOM")+"<\/h5><\/div><div class='table-col' style='float: left;width: 30%;border-right: 1px solid #000;box-sizing: border-box;padding: 10px 0;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_AttributeSetInstance")+"<\/h5><\/div><div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_Qty")+"<\/h5><\/div><\/div><div style='float: left;width: 100%;border-bottom: 3px solid #000;display: flex;'><div class='table-col' style='float: left; width: 30%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;word-wrap: break-word;word-break: break-all;'>"+s+"<\/p><\/div><div class='table-col' style='float: left;width: 30%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;word-wrap: break-word;word-break: break-all;'>"+h+"<\/p><\/div><div class='table-col' style='float: left;width: 30%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;word-wrap: break-word;word-break: break-all;'>"+e+"<\/p><\/div><div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;'><p style='margin: 0;word-wrap: break-word;word-break: break-all;'>"+c+"<\/p><\/div><\/div><\/div><div style='float: left;width: 100%; border: 1px solid #000;margin-top: 50px; margin-bottom: 20px;'><div style='float: left; width: 100%;'><div class='table-col' style='float: left;    width: 10%;   padding: 10px 0;    border-right: 1px solid #000;box-sizing: border-box;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_SerialNo")+"<\/h5><\/div><div class='table-col' style='float: left;    width: 50%;   padding: 10px 0;    border-right: 1px solid #000;box-sizing: border-box;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_BOMComponent")+"<\/h5><\/div><div class='table-col' style='float: left;    width: 30%;   padding: 10px 0;    border-right: 1px solid #000;box-sizing: border-box;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_AttributeSetInstance")+"<\/h5><\/div><div class='table-col' style='float: left;    width: 10%;   padding: 10px 0;box-sizing: border-box;padding-left: 10px;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;'>"+VIS.Msg.getMsg("VAMFG_Qty")+"<\/h5><\/div><\/div>",i=0;i<r.records.length;i++)i==0?(n+="<div style=' float: left;width: 100%;  display: flex;border-top:1px solid #000;'>",n+=" <div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+Math.ceil(i+1)+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 50%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].Product+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 30%;box-sizing: border-box;padding: 10px 0; padding-left: 10px;border-right: 1px solid #000;'><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].AttributeSetInstance+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0; padding-left: 10px;'><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].Qty+"<\/p><\/div>",n+="<\/div>"):(n+="<div style=' float: left;width: 100%; border-top: 1px solid #000;display: flex;'>",n+=" <div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0; padding-left: 10px;border-right: 1px solid #000; '><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+Math.ceil(i+1)+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 50%;box-sizing: border-box;padding: 10px 0;padding-left: 10px;border-right: 1px solid #000;  '><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].Product+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 30%;box-sizing: border-box;padding: 10px 0; padding-left: 10px;border-right: 1px solid #000; '><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].AttributeSetInstance+"<\/p><\/div>",n+=" <div class='table-col' style='float: left;width: 10%;box-sizing: border-box;padding: 10px 0; padding-left: 10px;'><p style='margin: 0;    word-wrap: break-word;word-break: break-all;'>"+r.records[i].Qty+"<\/p><\/div>",n+="<\/div>");n+="<\/div>";n+="<div style='float: left;width: 100%;margin-top: 120px;'><div style='width: 82%;margin: 0 auto;'><div class='table-col' style='float: left;width: 20%;padding: 10px 0;border-top: 1.5px solid #000;box-sizing: border-box;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;text-align: center;'>"+VIS.Msg.getMsg("VAMFG_AuthBy")+"<\/h5><\/div><div class='table-col' style='float: right;width: 20%;padding: 10px 0;border-top: 1.5px solid #000;box-sizing: border-box;'><h5 style='font-size: 16px;font-weight: bold;margin: 0;text-align: center;'>"+VIS.Msg.getMsg("VAMFG_ApproveBy")+"<\/h5><\/div>";n+="<\/div>";n+="<\/div>";f=window.open();f.document.write("<html ><head>");f.document.write("<\/head><body >");f.document.write(n);f.document.write("<\/body><\/html>");u[0].style.visibility="hidden";f.print();f=null;n=null}else o=VIS.Msg.getMsg("VAMFG_NoRecordsFound"),alert(o)});lt.on("click",function(){window.setTimeout(function(){hi()},20)});i=null;i=b();var v="",n="",a=0;rt.on(VIS.Events.onClick,function(){rt.w2overlay(i.clone(!0));v="Product";n="M_Product_ID";a=h.val()});ut.on(VIS.Events.onClick,function(){ut.w2overlay(i.clone(!0));n="C_Invoice_ID";a=f.val()});ft.on(VIS.Events.onClick,function(){ft.w2overlay(i.clone(!0));n="C_Order_ID";a=e.val()});et.on(VIS.Events.onClick,function(){et.w2overlay(i.clone(!0));v="Project";n="C_Project_ID";a=o.val()});ot.on(VIS.Events.onClick,function(){ot.w2overlay(i.clone(!0));v="Requisition";n="M_Requisition_ID";a=s.val()});st.on(VIS.Events.onClick,function(){st.w2overlay(i.clone(!0));v="Product";n="M_Product_ID";a=h.val()});if(i)i.on("click","LI",function(i){var r=t(i.target);r.data("action")=="Z"?k():r.data("action")=="R"&&(n=="M_Product_ID"?fi():n=="C_Invoice_ID"?si():n=="C_Order_ID"?ei():n=="C_Project_ID"?oi():n=="M_Requisition_ID"&&vt())});ht.click(function(){u[0].style.visibility="visible";var n=p.getValue();f.val()!="0"||o.val()!="0"||e.val()!="0"||s.val()!="0"?tr():(alert("Nothing Selected"),u[0].style.visibility="hidden")});ct.click(function(){$self.frame.dispose()});f.change(function(){f.prop("selectedIndex")==0?(e.prop("disabled",!1),o.prop("disabled",!1),s.prop("disabled",!1)):(e.prop("disabled",!0),o.prop("disabled",!0),s.prop("disabled",!0))});e.change(function(){e.prop("selectedIndex")==0?(f.prop("disabled",!1),o.prop("disabled",!1),s.prop("disabled",!1)):(f.prop("disabled",!0),o.prop("disabled",!0),s.prop("disabled",!0))});o.change(function(){o.prop("selectedIndex")==0?(f.prop("disabled",!1),e.prop("disabled",!1),s.prop("disabled",!1)):(f.prop("disabled",!0),e.prop("disabled",!0),s.prop("disabled",!0))});s.change(function(){s.prop("selectedIndex")==0?(f.prop("disabled",!1),e.prop("disabled",!1),o.prop("disabled",!1),l.prop("selectedIndex",0),w.hide(),l.hide()):(f.prop("disabled",!0),e.prop("disabled",!0),o.prop("disabled",!0),w.show(),l.show())});y.change(function(){u[0].style.visibility="visible";nr(VIS.Utility.Util.getValueOfDecimal(y.val()))})};ui=null;this.LoadBomGrid=function(){ai();v.length==0&&(v.push({field:"Product",caption:VIS.Msg.getMsg("VAMFG_BOMComponent"),sortable:!1,size:"30%"}),v.push({field:"Product_ID",caption:VIS.Msg.getMsg("Product_ID"),sortable:!1,size:"15%"}),v.push({field:"AttributeSetInstance",caption:VIS.Msg.getMsg("VAMFG_AttributeSetInstance"),sortable:!1,size:"30%"}),v.push({field:"AttributeSetInstance_ID",caption:VIS.Msg.getMsg("VAMFG_AttributeSetInstance"),sortable:!1,size:"15%"}),v.push({field:"Qty",caption:VIS.Msg.getMsg("VAMFG_Qty"),sortable:!1,size:"30%",editable:{type:"textbox"}}),v.push({field:"StaticQty",caption:VIS.Msg.getMsg("VAWMS_Qty"),sortable:!1,size:"20%"}));d.w2grid({name:"VAMFG_BomGrid_"+$self.windowNo,recordHeight:25,show:{selectColumn:!0},multiSelect:!0,columns:v});w2ui["VAMFG_BomGrid_"+$self.windowNo].hideColumn("Product_ID");w2ui["VAMFG_BomGrid_"+$self.windowNo].hideColumn("AttributeSetInstance_ID");w2ui["VAMFG_BomGrid_"+$self.windowNo].hideColumn("StaticQty");u[0].style.visibility="hidden"};this.resizeGrid=function(){d&&d.resize()};this.getRoot=function(){return r};yt={GetBomLines:function(n,i,r,u){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VAMFG/BOMDrop/GetBomLines",contentType:"application/json",data:JSON.stringify({AD_Client_ID:n,AD_Org_ID:i,M_BOM_ID:r}),success:function(n){u(n)}})},ProcessBomLines:function(n,i,r,u,f,e,o){t.ajax({type:"POST",url:VIS.Application.contextUrl+"VAMFG/BOMDrop/ProcessBomDrop",contentType:"application/json",data:JSON.stringify({C_Invoice_ID:n,C_Order_ID:i,C_Project_ID:r,M_Requisition_ID:u,DocStatus:f,ProcessData:e}),success:function(n){o(n)}})}};g=[];this.disposeComponent=function(){pt=null;h=null;wt=null;f=null;bt=null;e=null;kt=null;o=null;dt=null;y=null;d=null;ht=null;ct=null;gt=null;s=null;ni=null;nt=null;w=null;l=null;c=null;ti=null;ut=null;ft=null;lt=null;rt=null;et=null;ot=null;st=null;ZoomToTableID=null;ZoomToWindow=null;at=null;ZoomToRecord=0;n=null;ci=null;v=[];tt=!1;it=!1;ui=null;b=[];a={};k=[];w2ui["VAMFG_BomGrid_"+$self.windowNo].destroy();$self=null;r=null};i.prototype.dispose=function(){this.disposeComponent();this.frame&&this.frame.dispose();this.frame=null}}i.prototype.resize=function(){this.resizeGrid()};i.prototype.refresh=function(){this.resizeGrid()};i.prototype.init=function(n,t){this.windowNo=n;this.frame=t;this.Initialize();this.frame.getContentGrid().append(this.getRoot());this.LoadRoot();this.LoadBomGrid()};n.AForms=n.AForms||{};n.AForms.VBOMDrop=i}(VAMFG,jQuery)