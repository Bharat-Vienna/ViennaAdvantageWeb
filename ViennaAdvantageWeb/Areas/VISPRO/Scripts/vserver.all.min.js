VISPRO = window.VISPRO || {}, function (n, t) { n.Apps = n.Apps || {}; n.Apps.AForms = n.Apps.AForms || {}; n.Apps.AForms.VServer = function () { function k() { i = t("<div>"); i.css("position", "absolute"); i.css("bottom", "0"); i.css("background", "url('" + VIS.Application.contextUrl + "Areas/VIS/Images/LoadingCircle.gif') no-repeat"); i.css("background-position", "center center"); i.css("width", "98%"); i.css("height", "98%"); i.css("text-align", "center"); i.css("opacity", ".1"); i[0].style.visibility = "hidden"; o.append(i) } function d() { o = t("<div   style='height:100% ;overflow:auto;background-color:white' ><\/div>"); c = t("<div class='vispro-vserver-content-wrap' ><\/div>"); s = t('<div class="vis-awindow-header vis-menuTitle">'); o.height(t(window).height() - 70); h = t('<a href="javascript:void(0)"  class="vis-mainMenuIcons vis-icon-menuclose"><\/a>'); o.append(s.append("<p>" + VIS.Msg.getMsg("VISPRO_VServer") + " <\/p>").append(h)); l = t('<div class="vispro-vserver-top">'); f = t("<p><\/p>"); p = t('<div class="vispro-vserver-top-right">'); e = t("<input id=" + y + '_chkTrace" type="checkbox" checked>'); e.css("transform", "scale(1.3)"); v = t(" <label for=" + y + '_chkTrace">' + VIS.Msg.getMsg("TraceFile", !1, !1) + "<\/label>"); p.append(e).append(v); l.append(f).append(p); a = t(' <div class="vispro-vserver-feed-wrap">'); u = t("<ul><\/ul>"); a.append(u); c.append(l).append(a); o.append(c) } function g() { r.push({ code: "SP", Process: "Scheduler", port: "Default", status: "Stopped", desc: "VISPRO_SchedulerDescription" }); r.push({ code: "AP", Process: "Account Processor", port: "Default", status: "Stopped", desc: "VISPRO_AccountProcessorDescription" }); r.push({ code: "AL", Process: "Alert Processor", port: "Default", status: "Stopped", desc: "VISPRO_AlertProcessorDescription" }); r.push({ code: "RP", Process: "Request Processor", port: "Default", status: "Stopped", desc: "VISPRO_RequestProcessorDescription" }); r.push({ code: "WP", Process: "Workflow Processor", port: "Default", status: "Stopped", desc: "VISPRO_WorkflowProcessorDescription" }) } function nt() { i[0].style.visibility = "visible"; t.ajax({ url: VIS.Application.contextUrl + "VISPRO/VServer/IsServerRunning", datatype: "json", type: "post", data: { AD_client_ID: VIS.Env.getCtx().getAD_Client_ID(), appURL: VIS.Application.contextFullUrl }, success: function (t) { var e, u; if (i[0].style.visibility = "hidden", t == null || t == "null") { for (u = 0; u < r.length; u++) w(r[u], !1); n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Slide.png"); n.prop("title", VIS.Msg.getMsg("Start").replace("&", "")); n.data("status", "stop"); f.text(VIS.Msg.getMsg("ClickStart")) } else for (f.text(VIS.Msg.getMsg("VServerNote")), c.css("opacity", "0.5"), e = JSON.parse(t), n.data("status", "start"), n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Stop.png"), n.prop("title", VIS.Msg.getMsg("VISPRO_Stop").replace("&", "")), u = 0; u < r.length; u++) e.indexOf(r[u].code) > -1 ? w(r[u], !0) : w(r[u], !1) } }) } function w(i, r) { var e = t("<li><\/li>"), s = t('<div  class="vispro-vserver-feed-left"><\/div>'), h = t('<div  class="vispro-vserver-feed-top"><\/div>'), c, f, o; c = n.data("status") == "stop" ? t('<h4   data-type="' + i.code + '" >' + i.Process + '<\/h4>  <input  type="checkBox">') : r == !0 ? t('<h4    data-type="' + i.code + '" >' + i.Process + '<\/h4>  <img data-type="chk" src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/Cheked-box.png">') : t('<h4    data-type="' + i.code + '" >' + i.Process + '<\/h4>  <img data-type="chk" src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/Unchecked-box.png">'); h.append(c); f = t(' <div class="vispro-vserver-feed-bottom">'); r == !0 ? f.append(t("<p>" + VIS.Msg.getMsg("ServerRunning") + '<\/p><img  class="vispro-vserver-loader"  src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/loader.gif">')) : f.append(t("<p>" + VIS.Msg.getMsg("ServerStopped") + "<\/p>")); s.append(h).append(f); o = t('<div class="vispro-vserver-feed-text">'); o.append(t("<p>" + VIS.Msg.getMsg(i.desc) + "<\/p>")); e.append(s).append(o); e.find("input").css("transform", "scale(1.3)"); u.append(e) } function tt() { n = t('<img data-status="stop"  class="vispro-vserver-startbtn" title="' + VIS.Msg.getMsg("Start").replace("&", "") + '" src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/Stop.png"> <\/img>'); s.append(n) } function it() { n.on("click", rt); h.click(function () { b.dispose() }); u.on("click", st) } function rt() { n.data("status") == "stop" ? ut() : ft() } function ut() { for (var o = [], s = u.find("input:checked"), r = 0; r < s.length; r++) o.push(t(s[r]).siblings("h4").data("type")); if (o.length == 0) { VIS.ADialog.info("NoServerSelected"); return } i[0].style.visibility = "visible"; t.ajax({ url: VIS.Application.contextUrl + "VISPRO/VServer/OnServer", type: "get", datatype: "json", data: { AD_Client_ID: VIS.Env.getCtx().getAD_Client_ID(), appURL: VIS.Application.contextFullUrl, processOption: JSON.stringify(o), traceFile: e.prop("checked") }, success: function (t) { var r = JSON.parse(t); r == !0 ? (c.css("opacity", "0.5"), n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Stop.png"), n.prop("title", VIS.Msg.getMsg("VISPRO_Stop").replace("&", "")), n.data("status", "start"), et(), f.text(VIS.Msg.getMsg("VServerNote"))) : (n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Slide.png"), n.prop("title", VIS.Msg.getMsg("Start").replace("&", "")), n.data("status", "stop"), VIS.ADialog.info("ServerNotRunning")); i[0].style.visibility = "hidden" } }) } function ft() { i[0].style.visibility = "visible"; t.ajax({ url: VIS.Application.contextUrl + "VISPRO/VServer/StopServer", type: "get", datatype: "json", data: { req: !0, AD_Client_ID: VIS.Env.getCtx().getAD_Client_ID(), appURL: VIS.Application.contextFullUrl }, success: function (t) { var r = JSON.parse(t); r == !0 ? (c.css("opacity", "1"), n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Slide.png"), n.prop("title", VIS.Msg.getMsg("Start").replace("&", "")), n.data("status", "stop"), f.text(VIS.Msg.getMsg("ClickStart")), ot()) : (VIS.ADialog.info("ServerNotStoped"), n.prop("src", VIS.Application.contextUrl + "Areas/VISPRO/Images/Stop.png"), n.prop("title", VIS.Msg.getMsg("VISPRO_Stop").replace("&", "")), n.data("status", "start")); i[0].style.visibility = "hidden" } }) } function et() { for (var i = u.children("li"), n = 0; n < i.length; n++) t(t(i[n]).find("input")).prop("checked") == !0 ? (t(t(i[n]).find(".vispro-vserver-feed-top")).append(t('<img  data-type="chk"  src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/Cheked-box.png">')), t(t(i[n]).find(".vispro-vserver-feed-bottom")).append(t('<img class="vispro-vserver-loader" src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/loader.gif">')), t(i[n]).find(".vispro-vserver-feed-bottom p").text(VIS.Msg.getMsg("ServerRunning"))) : (t(t(i[n]).find(".vispro-vserver-feed-top")).append(t('<img  data-type="chk"  src="' + VIS.Application.contextUrl + 'Areas/VISPRO/Images/Unchecked-box.png">')), t(i[n]).find(".vispro-vserver-feed-bottom p").text(VIS.Msg.getMsg("ServerStopped"))), t(t(i[n]).find(".vispro-vserver-feed-top input")).remove() } function ot() { for (var i = u.children("li"), n = 0; n < i.length; n++) t(t(i[n]).find(".vispro-vserver-feed-top img")).remove(), t(t(i[n]).find(".vispro-vserver-feed-top")).append(t('<input type="checkBox" >')), t(i[n]).find(".vispro-vserver-feed-bottom img").remove(), t(i[n]).find(".vispro-vserver-feed-bottom p").text(VIS.Msg.getMsg("ServerStopped")), t(i[n]).find("input").css("transform", "scale(1.3)") } function st(i) { t(i.target).is("img") && t(i.target).data("type") == "chk" && n.data("status") == "start" && VIS.ADialog.info(VIS.Msg.getMsg("VServerNote")) } var y = VIS.Env.getWindowNo(), o, n, s, h, u, e, c, l, f, p, v, a, i, r = [], b = this; this.initializeComponent = function () { d(); k(); g(); tt(); nt(); it() }; this.disposeComponent = function () { y = null; e != null && (e.remove(), e = null); u != null && (u.remove(), u = null); h != null && (h.remove(), h = null); s != null && (s.remove(), s = null); n != null && (n.remove(), n = null); i != null && (i.remove(), i = null); a != null && (a.remove(), a = null); v != null && (v.remove(), v = null); f != null && (f.remove(), f = null); l != null && (l.remove(), l = null); r = null; b = null }; this.getRoot = function () { return o } }; n.Apps.AForms.VServer.prototype.init = function (n, t) { this.frame = t; this.windowNo = n; t.hideHeader(!0); this.initializeComponent(); this.frame.getContentGrid().append(this.getRoot()) }; n.Apps.AForms.VServer.prototype.dispose = function () { this.disposeComponent(); this.frame && this.frame.dispose(); this.frame = null } }(VISPRO, jQuery)